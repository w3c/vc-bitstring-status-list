<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 35.2.2">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Bitstring Status List v1.0</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    
    
    
<style>

code {
  color: rgb(199, 73, 0);
  font-weight: bold;
}
pre {
  overflow-x: auto;
  white-space: pre-wrap;
}
pre .highlight {
  font-weight: bold;
  color: Green;
}
pre .subject {
  font-weight: bold;
  color: RoyalBlue;
}
pre .property {
  font-weight: bold;
  color: DarkGoldenrod;
}
pre .comment {
  font-weight: bold;
  color: SteelBlue;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}
.color-text {
  font-weight: bold;
  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
}
ol.algorithm {
  counter-reset: numsection;
  list-style-type: none;
}
ol.algorithm li {
  margin: 0.5em 0;
}
ol.algorithm li:before {
  font-weight: bold;
  counter-increment: numsection;
  content: counters(numsection, ".") ") ";
}
.supported {
  background-color: #93c47d;
}
.missing {
  background-color: #e06666;
}
table.simple {
    border-collapse: collapse;
    margin: 25px 0;
    min-width: 400px;
    border: 1px solid #dddddd;
}
table.simple thead tr {
    background-color: #005a9c;
    color: #ffffff;
    text-align: left;
}
table.simple th,
table.simple td {
    padding: 12px 15px;
    vertical-align: top;
    text-align: left;
}
table.simple tbody tr {
    border-bottom: 1px solid #dddddd;
}
table.simple tbody tr:nth-of-type(even) {
    background-color: #00000008;
}
table.simple tbody tr:last-of-type {
    border-bottom: 2px solid #005a9c;
}
    
</style>
  
<meta name="color-scheme" content="light">
<meta name="description" content="This specification describes a privacy-preserving, space-efficient, and
high-performance mechanism for publishing status information such as
suspension or revocation of Verifiable Credentials through use of bitstrings.">
<link rel="canonical" href="https://www.w3.org/TR/vc-bitstring-status-list/">
<script type="application/ld+json">{
  "@context": [
    "http://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en",
      "w3p": "http://www.w3.org/2001/02pd/rec54#",
      "foaf": "http://xmlns.com/foaf/0.1/",
      "datePublished": {
        "@type": "http://www.w3.org/2001/XMLSchema#date"
      },
      "inLanguage": {
        "@language": null
      },
      "isBasedOn": {
        "@type": "@id"
      },
      "license": {
        "@type": "@id"
      }
    }
  ],
  "id": "https://www.w3.org/TR/vc-bitstring-status-list/",
  "type": [
    "TechArticle",
    "w3p:PR"
  ],
  "name": "Bitstring Status List v1.0",
  "inLanguage": "en",
  "license": "https://www.w3.org/copyright/software-license-2023/",
  "datePublished": "2025-03-20",
  "copyrightHolder": {
    "name": "World Wide Web Consortium",
    "url": "https://www.w3.org/"
  },
  "discussionUrl": "https://github.com/w3c/vc-bitstring-status-list/issues/",
  "alternativeHeadline": "Privacy-preserving status information for Verifiable Credentials",
  "isBasedOn": "",
  "description": "This specification describes a privacy-preserving, space-efficient, and\nhigh-performance mechanism for publishing status information such as\nsuspension or revocation of Verifiable Credentials through use of bitstrings.",
  "editor": [
    {
      "type": "Person",
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://www.digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://github.com/dlongley",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://www.digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Mike Prorock",
      "url": "https://www.mesur.io/",
      "worksFor": {
        "name": "mesur.io",
        "url": "https://www.mesur.io/"
      }
    },
    {
      "type": "Person",
      "name": "Mahmoud Alkhraishi",
      "url": "https://github.com/mkhraisha",
      "worksFor": {
        "name": "Mavennet",
        "url": "https://www.mavennet.com/"
      }
    }
  ],
  "contributor": [
    {
      "type": "Person",
      "name": "Dave Longley",
      "url": "https://github.com/dlongley",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://www.digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "worksFor": {
        "name": "Digital Bazaar",
        "url": "https://www.digitalbazaar.com/"
      }
    },
    {
      "type": "Person",
      "name": "Orie Steele",
      "url": "https://github.com/OR13",
      "worksFor": {
        "name": "Transmute",
        "url": "https://transmute.industries/"
      }
    }
  ],
  "citation": [
    {
      "id": "https://www.w3.org/TR/vc-data-model-2.0/",
      "type": "TechArticle",
      "name": "Verifiable Credentials Data Model v2.0",
      "url": "https://www.w3.org/TR/vc-data-model-2.0/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Ted Thibodeau Jr"
        },
        {
          "name": "Ivan Herman"
        },
        {
          "name": "Gabe Cohen"
        },
        {
          "name": "Michael Jones"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc4648",
      "type": "TechArticle",
      "name": "The Base16, Base32, and Base64 Data Encodings",
      "url": "https://www.rfc-editor.org/rfc/rfc4648",
      "creator": [
        {
          "name": "S. Josefsson"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc1952",
      "type": "TechArticle",
      "name": "GZIP file format specification version 4.3",
      "url": "https://www.rfc-editor.org/rfc/rfc1952",
      "creator": [
        {
          "name": "P. Deutsch"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/xmlschema11-2/",
      "type": "TechArticle",
      "name": "W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes",
      "url": "https://www.w3.org/TR/xmlschema11-2/",
      "creator": [
        {
          "name": "David Peterson"
        },
        {
          "name": "Sandy Gao"
        },
        {
          "name": "Ashok Malhotra"
        },
        {
          "name": "Michael Sperberg-McQueen"
        },
        {
          "name": "Henry Thompson"
        },
        {
          "name": "Paul V. Biron"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9457",
      "type": "TechArticle",
      "name": "Problem Details for HTTP APIs",
      "url": "https://www.rfc-editor.org/rfc/rfc9457",
      "creator": [
        {
          "name": "M. Nottingham"
        },
        {
          "name": "E. Wilde"
        },
        {
          "name": "S. Dalal"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2119",
      "type": "TechArticle",
      "name": "Key words for use in RFCs to Indicate Requirement Levels",
      "url": "https://www.rfc-editor.org/rfc/rfc2119",
      "creator": [
        {
          "name": "S. Bradner"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8174",
      "type": "TechArticle",
      "name": "Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words",
      "url": "https://www.rfc-editor.org/rfc/rfc8174",
      "creator": [
        {
          "name": "B. Leiba"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/vc-data-integrity/",
      "type": "TechArticle",
      "name": "Verifiable Credential Data Integrity 1.0",
      "url": "https://www.w3.org/TR/vc-data-integrity/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Ted Thibodeau Jr"
        },
        {
          "name": "Ivan Herman"
        },
        {
          "name": "Dave Longley"
        },
        {
          "name": "Greg Bernstein"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc9458",
      "type": "TechArticle",
      "name": "Oblivious HTTP",
      "url": "https://www.rfc-editor.org/rfc/rfc9458",
      "creator": [
        {
          "name": "M. Thomson"
        },
        {
          "name": "C. A. Wood"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.w3.org/TR/rdf-concepts/",
      "type": "TechArticle",
      "name": "Resource Description Framework (RDF): Concepts and Abstract Syntax",
      "url": "https://www.w3.org/TR/rdf-concepts/",
      "creator": [
        {
          "name": "Graham Klyne"
        },
        {
          "name": "Jeremy Carroll"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://infra.spec.whatwg.org/",
      "type": "TechArticle",
      "name": "Infra Standard",
      "url": "https://infra.spec.whatwg.org/",
      "creator": [
        {
          "name": "Anne van Kesteren"
        },
        {
          "name": "Domenic Denicola"
        }
      ],
      "publisher": {
        "name": "WHATWG"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc5280",
      "type": "TechArticle",
      "name": "Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile",
      "url": "https://www.rfc-editor.org/rfc/rfc5280",
      "creator": [
        {
          "name": "D. Cooper"
        },
        {
          "name": "S. Santesson"
        },
        {
          "name": "S. Farrell"
        },
        {
          "name": "S. Boeyen"
        },
        {
          "name": "R. Housley"
        },
        {
          "name": "W. Polk"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc2560",
      "type": "TechArticle",
      "name": "X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP",
      "url": "https://www.rfc-editor.org/rfc/rfc2560",
      "creator": [
        {
          "name": "M. Myers"
        },
        {
          "name": "R. Ankney"
        },
        {
          "name": "A. Malpani"
        },
        {
          "name": "S. Galperin"
        },
        {
          "name": "C. Adams"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://www.rfc-editor.org/rfc/rfc8932",
      "type": "TechArticle",
      "name": "Recommendations for DNS Privacy Service Operators",
      "url": "https://www.rfc-editor.org/rfc/rfc8932",
      "creator": [
        {
          "name": "S. Dickinson"
        },
        {
          "name": "B. Overeinder"
        },
        {
          "name": "R. van Rijswijk-Deij"
        },
        {
          "name": "A. Mankin"
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    },
    {
      "id": "https://eprint.iacr.org/2022/1362.pdf",
      "type": "TechArticle",
      "name": "ALLOSAUR: Accumulator with Low-Latency Oblivious Sublinear Anonymous credential Updates with Revocations",
      "url": "https://eprint.iacr.org/2022/1362.pdf",
      "publisher": {
        "name": "Cryptology ePrint Archive"
      }
    },
    {
      "id": "https://www.w3.org/TR/json-ld11/",
      "type": "TechArticle",
      "name": "JSON-LD 1.1",
      "url": "https://www.w3.org/TR/json-ld11/",
      "creator": [
        {
          "name": "Gregg Kellogg"
        },
        {
          "name": "Pierre-Antoine Champin"
        },
        {
          "name": "Dave Longley"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/turtle/",
      "type": "TechArticle",
      "name": "RDF 1.1 Turtle",
      "url": "https://www.w3.org/TR/turtle/",
      "creator": [
        {
          "name": "Eric Prud'hommeaux"
        },
        {
          "name": "Gavin Carothers"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/html-rdfa/",
      "type": "TechArticle",
      "name": "HTML+RDFa 1.1 - Second Edition",
      "url": "https://www.w3.org/TR/html-rdfa/",
      "creator": [
        {
          "name": "Manu Sporny"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://www.w3.org/TR/cid-1.0/",
      "type": "TechArticle",
      "name": "Controlled Identifiers v1.0",
      "url": "https://www.w3.org/TR/cid-1.0/",
      "creator": [
        {
          "name": "Manu Sporny"
        },
        {
          "name": "Michael Jones"
        }
      ],
      "publisher": {
        "name": "W3C"
      }
    },
    {
      "id": "https://httpwg.org/specs/rfc7231.html",
      "type": "TechArticle",
      "name": "Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content",
      "url": "https://httpwg.org/specs/rfc7231.html",
      "creator": [
        {
          "name": "R. Fielding, Ed."
        },
        {
          "name": "J. Reschke, Ed."
        }
      ],
      "publisher": {
        "name": "IETF"
      }
    }
  ]
}</script>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<style>

.vc-tabbed {
  overflow-x: hidden;
  margin: 0 0;
}

.vc-tabbed [type="radio"] {
  display: none;
}

.vc-tabs {
  display: flex;
  align-items: stretch;
  list-style: none;
  padding: 0;
  border-bottom: 1px solid #ccc;
}

li.vc-tab {
  margin: unset;
}

.vc-tab > label {
  display: block;
  margin-bottom: -1px;
  padding: .4em .5em;
  border: 1px solid #ccc;
  border-top-right-radius: .4em;
  border-top-left-radius: .4em;
  background: #eee;
  color: #666;
  cursor: pointer;
  transition: all 0.3s;
}

.vc-tab:hover label {
  border-left-color: #333;
  border-top-color: #333;
  border-right-color: #333;
  color: #333;
}

.vc-tab-content {
  display: none;
}
.vc-tab-content > pre {
  white-space: pre-wrap;
}

.vc-jose-cose-tabbed, .vc-jose-cose-tabbed-jwt,
.vc-jose-cose-tabbed-sd-jwt, .vc-jose-cose-tabbed-cose,
.sd-jwt-tabbed {
  overflow-x: hidden;
  margin: 0 0;
}

.vc-jose-cose-tabbed [type="radio"], .vc-jose-cose-tabbed-jwt [type="radio"],
.vc-jose-cose-tabbed-sd-jwt [type="radio"],
.vc-jose-cose-tabbed-cose [type="radio"],
.sd-jwt-tabbed [type="radio"] {
  display: none;
}

.vc-jose-cose-tabs, .vc-jose-cose-jwt-tabs, .vc-jose-cose-sd-jwt-tabs,
.vc-jose-cose-cose-tabs,
.sd-jwt-tabs {
  display: flex;
  align-items: stretch;
  list-style: none;
  padding: 0;
  border-bottom: 1px solid #ccc;
}

li.vc-jose-cose-tab, li.vc-jose-cose-jwt-tab, li.vc-jose-cose-sd-jwt-tab,
li.vc-jose-cose-cose-tab,
li.sd-jwt-tab {
  margin: 0 0;
  margin-left: 8px;
}

.vc-jose-cose-tab>label, .vc-jose-cose-jwt-tab>label,
.vc-jose-cose-sd-jwt-tab>label, .vc-jose-cose-cose-tab>label,
.sd-jwt-tab>label {
  display: block;
  margin-bottom: -1px;
  padding: .4em .5em;
  border: 1px solid #ccc;
  border-top-right-radius: .4em;
  border-top-left-radius: .4em;
  background: #eee;
  color: #666;
  cursor: pointer;
  transition: all 0.3s;
}

.vc-jose-cose-tab:hover label, .vc-jose-cose-jwt-tab:hover label,
.vc-jose-cose-sd-jwt-tab:hover label, .vc-jose-cose-cose-tab:hover label,
.sd-jwt-tab:hover label {
  border-left-color: #333;
  border-top-color: #333;
  border-right-color: #333;
  color: #333;
}

.vc-jose-cose-tab-content,
.sd-jwt-tab-content {
  display: none;
}

.vc-tabbed [type="radio"]:nth-of-type(1):checked ~ .vc-tabs .vc-tab:nth-of-type(1) label,
  .vc-tabbed [type="radio"]:nth-of-type(2):checked ~ .vc-tabs .vc-tab:nth-of-type(2) label,
  .vc-tabbed [type="radio"]:nth-of-type(3):checked ~ .vc-tabs .vc-tab:nth-of-type(3) label,
  .vc-tabbed [type="radio"]:nth-of-type(4):checked ~ .vc-tabs .vc-tab:nth-of-type(4) label,
  .vc-tabbed [type="radio"]:nth-of-type(5):checked ~ .vc-tabs .vc-tab:nth-of-type(5) label,
  .vc-tabbed [type="radio"]:nth-of-type(6):checked ~ .vc-tabs .vc-tab:nth-of-type(6) label,
  .vc-tabbed [type="radio"]:nth-of-type(7):checked ~ .vc-tabs .vc-tab:nth-of-type(7) label,
  .vc-tabbed [type="radio"]:nth-of-type(8):checked ~ .vc-tabs .vc-tab:nth-of-type(8) label,
  .vc-tabbed [type="radio"]:nth-of-type(9):checked ~ .vc-tabs .vc-tab:nth-of-type(9) label,
  .vc-tabbed [type="radio"]:nth-of-type(10):checked ~ .vc-tabs .vc-tab:nth-of-type(10) label {
  border-bottom-color: #fff;
  background: #fff;
  color: #222;
}

.vc-tabbed [type="radio"]:nth-of-type(1):checked ~ .vc-tab-content:nth-of-type(1),
  .vc-tabbed [type="radio"]:nth-of-type(2):checked ~ .vc-tab-content:nth-of-type(2),
  .vc-tabbed [type="radio"]:nth-of-type(3):checked ~ .vc-tab-content:nth-of-type(3),
  .vc-tabbed [type="radio"]:nth-of-type(4):checked ~ .vc-tab-content:nth-of-type(4),
  .vc-tabbed [type="radio"]:nth-of-type(5):checked ~ .vc-tab-content:nth-of-type(5),
  .vc-tabbed [type="radio"]:nth-of-type(6):checked ~ .vc-tab-content:nth-of-type(6),
  .vc-tabbed [type="radio"]:nth-of-type(7):checked ~ .vc-tab-content:nth-of-type(7),
  .vc-tabbed [type="radio"]:nth-of-type(8):checked ~ .vc-tab-content:nth-of-type(8),
  .vc-tabbed [type="radio"]:nth-of-type(9):checked ~ .vc-tab-content:nth-of-type(9),
  .vc-tabbed [type="radio"]:nth-of-type(10):checked ~ .vc-tab-content:nth-of-type(10),
.sd-jwt-tabbed [type="radio"]:nth-of-type(1):checked ~ .sd-jwt-tab-content:nth-of-type(1),
.sd-jwt-tabbed [type="radio"]:nth-of-type(2):checked ~ .sd-jwt-tab-content:nth-of-type(2),
.sd-jwt-tabbed [type="radio"]:nth-of-type(3):checked ~ .sd-jwt-tab-content:nth-of-type(3) {
  display: block;
}

.disclosure {
  margin: 10px 0;
  font-size: 12px;
  line-height: 1.6;
  padding: 5px;
}

.disclosure h3 {
  margin: 0;
  font-size: 14px;
  padding-left: 5px;
}

.disclosure .claim-name {
  color: #333;
}

.disclosure .hash,
.disclosure .disclosure-value,
.disclosure .contents {
  color: #555;
  word-wrap: break-word;
  display: inline;
}

.disclosure p {
  margin: 0;
  padding-left: 5px;
}

.disclosure pre {
  white-space: pre-wrap;
  word-wrap: break-word;
  margin: 0;
  padding-left: 5px;
  line-height: 1.6;
  display: inline-block;
}

.header-value {
  white-space: pre-wrap;
  word-wrap: break-word;
  margin: 0;
  padding-left: 5px;
  line-height: 1.6;
  font-size: 12px;
}

.cose-text, .jose-text, .vc-jose-cose-jwt .text, .vc-jose-cose-sd-jwt .text,
 .vc-jose-cose-cose .text {
  font-family: monospace;
  color: green;
}

.sd-jwt-compact, .jwt-compact, .vc-jose-cose-jwt .compact, .vc-jose-cose-sd-jwt
 .compact, .vc-jose-cose-cose .compact {
  background-color: rgba(0,0,0,.03);
}

.sd-jwt-header, .jwt-header, .vc-jose-cose-jwt .header, .vc-jose-cose-sd-jwt
 .header, .vc-jose-cose-cose .header {
  color: red;
}

.sd-jwt-payload, .jwt-payload, .vc-jose-cose-jwt .payload, .vc-jose-cose-sd-jwt
 .payload, .vc-jose-cose-cose .payload {
  color: green;
}

.sd-jwt-signature, .jwt-signature, .vc-jose-cose-jwt .signature,
 .vc-jose-cose-sd-jwt .signature, .vc-jose-cose-cose .signature {
  color: blue;
}

.sd-jwt-disclosure, .vc-jose-cose-jwt .disclosure, .vc-jose-cose-sd-jwt
 .disclosure, .vc-jose-cose-cose .disclosure {
  color: purple;
}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "PR",
  "group": "vc",
  "shortName": "vc-bitstring-status-list",
  "subtitle": "Privacy-preserving status information for Verifiable Credentials",
  "publishDate": "2025-3-20",
  "crEnd": "2024-06-21",
  "prEnd": "2025-4-17",
  "implementationReportURI": "https://w3c.github.io/vc-bitstring-status-list-test-suite/",
  "localBiblio": {
    "ALLOSAUR": {
      "title": "ALLOSAUR: Accumulator with Low-Latency Oblivious Sublinear Anonymous credential Updates with Revocations",
      "href": "https://eprint.iacr.org/2022/1362.pdf",
      "date": "January 5th, 2024",
      "publisher": "Cryptology ePrint Archive",
      "id": "allosaur"
    }
  },
  "doJsonLd": true,
  "github": "https://github.com/w3c/vc-bitstring-status-list",
  "includePermalinks": false,
  "edDraftURI": "https://w3c.github.io/vc-bitstring-status-list/",
  "editors": [
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://www.digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Dave Longley",
      "url": "https://github.com/dlongley",
      "company": "Digital Bazaar",
      "companyURL": "https://www.digitalbazaar.com/",
      "w3cid": 48025
    },
    {
      "name": "Mike Prorock",
      "url": "https://www.mesur.io/",
      "company": "mesur.io",
      "companyURL": "https://www.mesur.io/",
      "w3cid": 130636
    },
    {
      "name": "Mahmoud Alkhraishi",
      "url": "https://github.com/mkhraisha",
      "company": "Mavennet",
      "companyURL": "https://www.mavennet.com/",
      "w3cid": 121911
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "https://github.com/dlongley",
      "company": "Digital Bazaar",
      "companyURL": "https://www.digitalbazaar.com/",
      "w3cid": 48025
    },
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://www.digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Orie Steele",
      "url": "https://github.com/OR13",
      "company": "Transmute",
      "companyURL": "https://transmute.industries/",
      "w3cid": 109171
    }
  ],
  "lint": {
    "no-unused-dfns": false,
    "informative-dfn": false
  },
  "xref": [
    "INFRA",
    "I18N-GLOSSARY",
    "VC-DATA-MODEL-2.0"
  ],
  "postProcess": [
    null
  ],
  "maxTocLevel": 2,
  "inlineCSS": true,
  "otherLinks": [
    {
      "key": "Related Documents",
      "data": [
        {
          "value": "Verifiable Credentials Data Model v2.0",
          "href": "https://www.w3.org/TR/vc-data-model-2.0/"
        }
      ]
    }
  ],
  "publishISODate": "2025-03-20T00:00:00.000Z",
  "generatedSubtitle": "W3C Proposed Recommendation 20 March 2025"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-PR"></head>
  <body class="h-entry" data-cite="INFRA I18N-GLOSSARY VC-DATA-MODEL-2.0"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Bitstring Status List v1.0</h1> <h2 id="subtitle" class="subtitle">Privacy-preserving status information for Verifiable Credentials</h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#PR">W3C Proposed Recommendation</a> <time class="dt-published" datetime="2025-03-20">20 March 2025</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2025/PR-vc-bitstring-status-list-20250320/">https://www.w3.org/TR/2025/PR-vc-bitstring-status-list-20250320/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/vc-bitstring-status-list/">https://www.w3.org/TR/vc-bitstring-status-list/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/vc-bitstring-status-list/">https://w3c.github.io/vc-bitstring-status-list/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/vc-bitstring-status-list/">https://www.w3.org/standards/history/vc-bitstring-status-list/</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/vc-bitstring-status-list/commits/">Commit history</a>
                  </dd>
        
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/vc-bitstring-status-list-test-suite/">https://w3c.github.io/vc-bitstring-status-list-test-suite/</a>
              </dd>
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://www.digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://github.com/dlongley">Dave Longley</a> (<a class="p-org org h-org" href="https://www.digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="130636">
    <a class="u-url url p-name fn" href="https://www.mesur.io/">Mike Prorock</a> (<a class="p-org org h-org" href="https://www.mesur.io/">mesur.io</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="121911">
    <a class="u-url url p-name fn" href="https://github.com/mkhraisha">Mahmoud Alkhraishi</a> (<a class="p-org org h-org" href="https://www.mavennet.com/">Mavennet</a>)
  </dd>
        
        <dt>Authors:</dt><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://github.com/dlongley">Dave Longley</a> (<a class="p-org org h-org" href="https://www.digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://www.digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="109171">
    <a class="u-url url p-name fn" href="https://github.com/OR13">Orie Steele</a> (<a class="p-org org h-org" href="https://transmute.industries/">Transmute</a>)
  </dd>
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/vc-bitstring-status-list/">GitHub w3c/vc-bitstring-status-list</a>
        (<a href="https://github.com/w3c/vc-bitstring-status-list/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/vc-bitstring-status-list/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/vc-bitstring-status-list/issues/">open issues</a>)
      </dd>
        
        <dt>Related Documents</dt><dd>
    <a href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a>
  </dd>
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/policies/#copyright">Copyright</a>
    ©
    2025
    
    <a href="https://www.w3.org/">World Wide Web Consortium</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
    <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/copyright/software-license-2023/" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes a privacy-preserving, space-efficient, and
high-performance mechanism for publishing status information such as
suspension or revocation of Verifiable Credentials through use of bitstrings.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/vc">Verifiable Credentials Working Group</a> as
    a Proposed Recommendation using the
        <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a Proposed Recommendation does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
        The <abbr title="World Wide Web Consortium">W3C</abbr> Membership and other interested parties are invited to review
        the document and send comments through 17 April 2025.
        Advisory Committee Representatives should consult their
        <a href="https://www.w3.org/2002/09/wbs/myQuestionnaires">WBS questionnaires</a>. Note that substantive technical comments were expected during the
        Candidate Recommendation review period that ended
        21 June 2024.
      </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/policies/patent-policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/vc/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                      This document is governed by the
                      <a id="w3c_process_revision" href="https://www.w3.org/policies/process/20231103/">03 November 2023 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                    </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#conceptual-framework"><bdi class="secno">1.1 </bdi>Conceptual Framework</a></li><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.2 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.3 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#bitstringstatuslistentry"><bdi class="secno">2.1 </bdi>BitstringStatusListEntry</a></li><li class="tocline"><a class="tocxref" href="#bitstringstatuslistcredential"><bdi class="secno">2.2 </bdi>BitstringStatusListCredential</a></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#generate-algorithm"><bdi class="secno">3.1 </bdi>Generate Algorithm</a></li><li class="tocline"><a class="tocxref" href="#validate-algorithm"><bdi class="secno">3.2 </bdi>Validate Algorithm</a></li><li class="tocline"><a class="tocxref" href="#bitstring-generation-algorithm"><bdi class="secno">3.3 </bdi>Bitstring Generation Algorithm</a></li><li class="tocline"><a class="tocxref" href="#bitstring-expansion-algorithm"><bdi class="secno">3.4 </bdi>Bitstring Expansion Algorithm</a></li><li class="tocline"><a class="tocxref" href="#processing-errors"><bdi class="secno">3.5 </bdi>Processing Errors</a></li><li class="tocline"><a class="tocxref" href="#securing-algorithms"><bdi class="secno">3.6 </bdi>Securing Algorithms</a></li></ol></li><li class="tocline"><a class="tocxref" href="#media-types"><bdi class="secno">4. </bdi>Media Types</a></li><li class="tocline"><a class="tocxref" href="#contexts-and-vocabularies"><bdi class="secno">5. </bdi>Contexts and Vocabularies</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#vocabulary"><bdi class="secno">5.1 </bdi>Vocabulary</a></li><li class="tocline"><a class="tocxref" href="#json-ld-context"><bdi class="secno">5.2 </bdi>JSON-LD context</a></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#revocation-bitstring-length"><bdi class="secno">6.1 </bdi>Revocation Bitstring Length</a></li><li class="tocline"><a class="tocxref" href="#unnecessary-correlation"><bdi class="secno">6.2 </bdi>Unnecessary Correlation</a></li><li class="tocline"><a class="tocxref" href="#verifier-caching"><bdi class="secno">6.3 </bdi>Verifier Caching</a></li><li class="tocline"><a class="tocxref" href="#content-distribution-networks"><bdi class="secno">6.4 </bdi>Content Distribution Networks</a></li><li class="tocline"><a class="tocxref" href="#decoy-values"><bdi class="secno">6.5 </bdi>Decoy Values</a></li><li class="tocline"><a class="tocxref" href="#malicious-issuers-and-verifiers"><bdi class="secno">6.6 </bdi>Malicious Issuers and Verifiers</a></li><li class="tocline"><a class="tocxref" href="#monitoring-status-lists"><bdi class="secno">6.7 </bdi>Monitoring Status Lists</a></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">7. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#bitstring-encoding"><bdi class="secno">7.1 </bdi>Bitstring Encoding</a></li><li class="tocline"><a class="tocxref" href="#validity-periods"><bdi class="secno">7.2 </bdi>Validity Periods</a></li></ol></li><li class="tocline"><a class="tocxref" href="#accessibility-considerations"><bdi class="secno">8. </bdi>Accessibility Considerations</a></li><li class="tocline"><a class="tocxref" href="#internationalization-considerations"><bdi class="secno">9. </bdi>Internationalization Considerations</a></li><li class="tocline"><a class="tocxref" href="#examples"><bdi class="secno">A. </bdi>Examples</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#revocable-verifiable-credential"><bdi class="secno">A.1 </bdi>Revocable Verifiable Credential</a></li><li class="tocline"><a class="tocxref" href="#status-list-verifiable-credential"><bdi class="secno">A.2 </bdi>Status List Verifiable Credential</a></li><li class="tocline"><a class="tocxref" href="#multiple-status-lists-in-one-verifiable-credential"><bdi class="secno">A.3 </bdi>Multiple Status Lists in One Verifiable Credential</a></li><li class="tocline"><a class="tocxref" href="#multiple-status-entries-in-a-single-list"><bdi class="secno">A.4 </bdi>Multiple Status Entries in a Single List</a></li></ol></li><li class="tocline"><a class="tocxref" href="#revision-history"><bdi class="secno">B. </bdi>Revision History</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">C. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">C.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">C.2 </bdi>Informative references</a></li></ol></li></ol></nav>

    <section class="informative" id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
It is often useful for an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> of <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>] to link to a location where a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> can check to see
if a credential has been suspended or revoked. There are a variety of privacy
and performance considerations that are made when designing, publishing, and
processing status lists.
      </p>
      <p>
One such privacy consideration happens when there is a one-to-one mapping
between a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> and a URL where the status is
published. This type of mapping enables the website that publishes the URL to
correlate the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a>, time, and <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> when the status is
checked. This could enable the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> to discover the type of interaction
the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> is having with the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>, such as providing an age
verification credential when entering a bar. Being tracked by the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>
of a driver's license when entering an establishment violates a privacy
expectation that many people have today.
      </p>
      <p>
Similarly, there are performance considerations that are explored when designing
status lists. One such consideration is where the list is published and the
burden it places from a bandwidth and processing perspective, both on the server
and the client fetching the information. In order to meet privacy expectations,
it is useful to bundle the status of large sets of credentials into a single
list to help with group privacy. However, doing so can place an impossible
burden on both the server and client if the status information is as much as a
few hundred bytes in size per credential across a population of
hundreds of millions of <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a>.
      </p>
      <p>
The rest of this document proposes a highly compressible, bitstring-based
status list mechanism with strong privacy-preserving characteristics,
that is compatible with the architecture of the Web, is highly space-efficient,
and lends itself well to content distribution networks. As an example of
using this specification to achieve a number of beneficial privacy and
performance goals, it is possible to create a status list that can be
constructed for 100,000 <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> that is roughly
12,500 bytes in size in the worst case. In a case where a few hundred
credentials have been revoked, the size of the list is less than a
few hundred bytes while providing privacy in a group of 100,000 individuals.
      </p>

      <section class="informative" id="conceptual-framework"><div class="header-wrapper"><h3 id="x1-1-conceptual-framework"><bdi class="secno">1.1 </bdi>Conceptual Framework</h3><a class="self-link" href="#conceptual-framework" aria-label="Permalink for Section 1.1"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
This section outlines the core concept utilized by the status list
mechanism described in this specification. At the most basic level, status
information for all <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> issued by an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>
is expressed as items in a list. Each <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> manages a list
of all <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> that it has issued. Each
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> is associated with an item in its list.
When a single bit specifies a status, such as "revoked" or "suspended",
then that status is expected to be true when the bit is set (<code>1</code>) and
false when unset (<code>0</code>).
        </p>

        <p>
One of the benefits of using a bitstring is that it is a highly compressible
data format since, in the average case, large numbers of credentials will
remain unrevoked. This will ensure long sections of bits that are the same
value and thus highly compressible using run-length compression techniques
such as GZIP [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1952" title="GZIP file format specification version 4.3">RFC1952</a></cite>]. The default status list size is 131,072 entries,
equivalent to 16&nbsp;KB of single bit values. When only a handful of
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> are revoked, GZIP compresses the bitstring
to a few hundred bytes.
        </p>

        <p>
Another benefit of using a bitstring is that it enables large numbers of
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> statuses to be placed in the same list.
This specification uses a minimum list length of 131,072. This
size ensures an adequate amount of group privacy in the average case.
If better group privacy is required, the bitstring can be made larger.
        </p>

        <figure id="bitstring">
          <img style="margin: auto; display: block; width: 75%;" src="diagrams/BitstringStatusListConcept.svg" alt="
          diagram showing a list of boxes at the top of the image with two of
          them in red depicting revoked credentials. Text beside the boxes to
          the right reads 16 kilobytes. An depiction of the boxes being GZIP
          compressed into a cylinder on the bottom of the page shows that
          compression has resulted in a final size of 135 bytes.">
          <figcaption style="text-align: center;"><a class="self-link" href="#bitstring">Figure <bdi class="figno">1</bdi></a> <span class="fig-title">
            A visual depiction of the concepts outlined in this section.
          </span></figcaption>
        </figure>

        <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="4"><span>Note</span><span class="issue-label">: Status information is about the verifiable credential</span></div><p class="">
The status information associated with a particular <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
is about the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> itself and might not apply to any
underlying or backing <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-credential">credential</a>, such as an educational degree. For
example, in the case of such an educational degree, it is possible for a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> to be revoked because the mechanism used to
create its digital signature has been compromised, while the backing educational
degree remains valid.
        </p></div>

      </section>

      <section class="informative" id="terminology"><div class="header-wrapper"><h3 id="x1-2-terminology"><bdi class="secno">1.2 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.2"></a></div><p><em>This section is non-normative.</em></p>
        

        <p>
Terminology used throughout this document is defined in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#terminology">Terminology</a> section of the
<cite><a data-matched-text="[[[VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite> specification.
        </p>
      </section>

      <section id="conformance" class="normative"><div class="header-wrapper"><h3 id="x1-3-conformance"><bdi class="secno">1.3 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.3"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, <em class="rfc2119">OPTIONAL</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>

        <p>
A <dfn id="dfn-conforming-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming document</dfn> is any concrete expression of the
data model that follows the relevant normative requirements in Section
<a href="#data-model" class="sec-ref"><bdi class="secno">2. </bdi>Data Model</a>.
        </p>

        <p>
A <dfn id="dfn-conforming-processor" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming processor</dfn> is any algorithm realized
as software and/or hardware that generates and/or consumes a
<a data-link-type="dfn|abstract-op" href="#dfn-conforming-document" class="internalDFN" id="ref-for-dfn-conforming-document-1">conforming document</a> according to the relevant normative statements in
Section <a href="#algorithms" class="sec-ref"><bdi class="secno">3. </bdi>Algorithms</a>. Conforming processors <em class="rfc2119">MAY</em> choose to only
support bitstring entry sizes of 1. Conforming processors <em class="rfc2119">MUST</em> produce errors
when non-conforming documents are consumed.
        </p>

      </section>

    </section>

    <section class="normative" id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      

      <p>
There are numerous ways to express status information associated with digital
credentials. Some of these mechanisms include Certificate Revocation Lists (CRL)
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">RFC5280</a></cite>], the Online Certificate Status Protocol (OCSP) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2560" title="X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP">RFC2560</a></cite>], Bloom
Filters [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8932" title="Recommendations for DNS Privacy Service Operators">RFC8932</a></cite>], and cryptographic accumulators [<cite><a class="bibref" data-link-type="biblio" href="#bib-allosaur" title="ALLOSAUR: Accumulator with Low-Latency Oblivious Sublinear Anonymous credential Updates with Revocations">ALLOSAUR</a></cite>]. This
specification optimizes for a variety of requirements that are different from
other mechanisms. These requirements include:
      </p>

      <table class="simple" id="#pfatable">
        <thead>
        <tr>
            <th style="text-align: center;">Technology</th>
            <th style="text-align: center;">CRL</th>
            <th style="text-align: center;">OCSP</th>
            <th style="text-align: center;">Bloom</th>
            <th style="text-align: center;">Accumulator</th>
            <th style="text-align: center;">Bitstring</th>
        </tr>
        </thead>
        <tbody>
          <tr>
            <td>
Provides tunable group privacy
            </td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Does not require signed assertion for each credential
            </td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Resistant to <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> tracking when fetched by <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>
            </td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Caching is space efficient with many revocations
            </td>
            <td class="missing">✗</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Highly compressible (&gt;90% average compression)
            </td>
            <td class="missing">✗</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Updates are efficient (fast and entire population does not need to update)
            </td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Uses cryptographic primitives approved by IETF
            </td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
No false positives
            </td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Can be delivered by <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> (stapling)
            </td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
            <td class="supported">✓</td>
          </tr>
          <tr>
            <td>
Easily profiled for usage with <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>
            </td>
            <td class="missing">✗</td>
            <td class="missing">✗</td>
            <td class="missing">✗</td>
            <td class="missing">✗</td>
            <td class="supported">✓</td>
          </tr>
        </tbody>
      </table>

      <section id="bitstringstatuslistentry"><div class="header-wrapper"><h3 id="x2-1-bitstringstatuslistentry"><bdi class="secno">2.1 </bdi>BitstringStatusListEntry</h3><a class="self-link" href="#bitstringstatuslistentry" aria-label="Permalink for Section 2.1"></a></div>
        

        <p>
When an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> desires to enable status information for a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>, they <em class="rfc2119">MAY</em> add a <code>credentialStatus</code>
property that uses the data model described in this section. Any
expression of the data model in this section <em class="rfc2119">MUST</em> be expressed in a
conforming <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>].
        </p>

        <table class="simple">
          <thead>
            <tr>
              <th style="white-space: nowrap">Property</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>id</td>
              <td>
An optional identifier for the status list entry. The constraints on the <code>id</code>
property are listed in the Verifiable Credentials Data Model specification
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>]. If present, the value is expected to be a URL that
identifies the status information associated with the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable
credential</a>. It <em class="rfc2119">MUST NOT</em> be the URL for the status list. The value is not
used during the verification or validation process, and does not need to be
related to the <code>statusListCredential</code> value. If necessary, the value can be used
to uniquely identify the <code>BitstringStatusListEntry</code> object, such as when it is
stored in a database.
              </td>
            </tr>
            <tr>
              <td>type</td>
              <td>
The <code>type</code> property <em class="rfc2119">MUST</em> be <code>BitstringStatusListEntry</code>.
              </td>
            </tr>
            <tr>
              <td>statusPurpose</td>
              <td>
The purpose of the status entry <em class="rfc2119">MUST</em> be a string. While the value of the
string is arbitrary, the following values <em class="rfc2119">MUST</em> be used for their intended
purpose:
                <table class="simple">
                  <thead>
                    <tr>
                      <th style="white-space: nowrap">Value</th>
                      <th>Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><code>refresh</code></td>
                      <td>
Used to signal that an updated <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> is available via the
credential's <a href="https://www.w3.org/TR/vc-data-model-2.0/#refreshing">refresh service</a>
feature. This status does not invalidate the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> and is
not reversible.
                      </td>
                    </tr>
                    <tr>
                      <td><code>revocation</code></td>
                      <td>
Used to cancel the validity of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>. This status is
not reversible.
                      </td>
                    </tr>
                    <tr>
                      <td><code>suspension</code></td>
                      <td>
Used to temporarily prevent the acceptance of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
This status is reversible.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td>statusListIndex</td>
              <td>
The <code>statusListIndex</code> property <em class="rfc2119">MUST</em> be an arbitrary size integer
greater than or equal to 0, expressed as a string in base 10. The value identifies the
position of the status of the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>. Implementations
<em class="rfc2119">SHOULD</em> assign indexes randomly, such that inferences — such as the recency
of the assignment or the size of the group — cannot be easily drawn from
that position.
              </td>
            </tr>
            <tr>
              <td>statusListCredential</td>
              <td>
The <code>statusListCredential</code> property <em class="rfc2119">MUST</em> be a URL to a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>. When the URL is dereferenced, the resulting
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> <em class="rfc2119">MUST</em> have <code>type</code> property that
includes the <code>BitstringStatusListCredential</code> value.
              </td>
            </tr>
          </tbody>
        </table>


        <p>
Status list entries can be used to express the purpose of a
status associated with a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> by using the
<code>statusPurpose</code> property.
        </p>
        <p>
The use of <code>revocation</code> or <code>suspension</code> as the status purpose
includes the semantics of the status, with <code>revocation</code>
indicating that a status bit expresses whether a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> has been revoked and <code>suspension</code>
indicating that a status bit expresses whether a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> has been suspended. The example below
demonstrates the use of these status purposes:
        </p>

        <div class="example" id="example-example-statuslistcredential-using-simple-entries">
        <div class="marker">
    <a class="self-link" href="#example-example-statuslistcredential-using-simple-entries">Example<bdi> 1</bdi></a><span class="example-title">: Example StatusListCredential using simple entries</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": ["VerifiableCredential", "EmployeeIdCredential"],
  "issuer": "did:example:12345",
  "validFrom": "2024-04-05T14:27:42Z",
  <span class="highlight">"credentialStatus": [{
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  }, {
    "id": "https://example.com/credentials/status/4#23452",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "suspension",
    "statusListIndex": "23452",
    "statusListCredential": "https://example.com/credentials/status/4"
  }]</span>,
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person",
    "employeeId": "A-123456"
  }
}</pre>
      </div>

        <div class="note" role="note" id="issue-container-generatedID-0"><div role="heading" class="note-title marker" id="h-note-0" aria-level="4"><span>Note</span></div><p class="">
It is important to note that <code>statusListIndex</code> is the only link between
the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> and its status in the list. Other
properties such as <code>credentialSubject.id</code> are not used for
this purpose.
        </p></div>

      </section>

      <section id="bitstringstatuslistcredential"><div class="header-wrapper"><h3 id="x2-2-bitstringstatuslistcredential"><bdi class="secno">2.2 </bdi>BitstringStatusListCredential</h3><a class="self-link" href="#bitstringstatuslistcredential" aria-label="Permalink for Section 2.2"></a></div>
        

        <p>
When a status list <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> is published, it <em class="rfc2119">MUST</em> be a
conforming document, as defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-model-2.0" title="Verifiable Credentials Data Model v2.0">VC-DATA-MODEL-2.0</a></cite>], that expresses the
data model in this section. The following section describes the format of
the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that encapsulates the status list.
        </p>

        <p>
The status list is expressed inside a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> in order to
enable a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> to provide it directly to a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>. This mechanism,
sometimes called "certificate stapling", increases privacy for the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> by
ensuring that the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> does not need to contact the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> to
retrieve the status list. Still, a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> might choose to ignore the
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a>-provided status list, even when its authenticity is verifiable,
if it desires a more recent version of a status list, for instance.
        </p>

        <p>
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuers</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a> are advised that the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> of a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> and the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> of an associated
<code>BitstringStatusListCredential</code> might not be the same. There are technical,
legal, institutional, political, and other reasons that might make it
appropriate to separate the authority over the original credential from the
authority to revoke, or otherwise change the status of, such a credential.
Therefore, the <code>issuer</code> value of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> containing a
<code>BitstringStatusListEntry</code> <em class="rfc2119">MAY</em> be different from the <code>issuer</code> value of a
<code>BitstringStatusListCredential</code>.
        </p>

        <table class="simple">
          <thead>
            <tr>
              <th style="white-space: nowrap">Property</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>id</td>
              <td>
The <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that contains the status list <em class="rfc2119">MAY</em>
express an <code>id</code> property that matches the value specified in
<code>statusListCredential</code> for the corresponding
<code>BitstringStatusListEntry</code> (see <a href="#bitstringstatuslistentry" class="sec-ref"><bdi class="secno">2.1 </bdi>BitstringStatusListEntry</a>).
              </td>
            </tr>
            <tr>
              <td>type</td>
              <td>
The <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that contains the status list <em class="rfc2119">MUST</em>
express a <code>type</code> property that includes the
<code>BitstringStatusListCredential</code> value.
              </td>
            </tr>
            <tr>
              <td>validFrom</td>
              <td>
The earliest point in time at which the status list is valid. This property is
defined in the Verifiable Credentials Data Model specification in
<a href="https://www.w3.org/TR/vc-data-model-2.0/#validity-period">
Section 4.6: Validity Period</a>.
              </td>
            </tr>
            <tr>
              <td>validUntil</td>
              <td>
The latest point in time at which the status list is valid. This property is
defined in the Verifiable Credentials Data Model specification in
<a href="https://www.w3.org/TR/vc-data-model-2.0/#validity-period">
Section 4.6: Validity Period</a>.
              </td>
            </tr>
            <tr>
              <td>credentialSubject.type</td>
              <td id="BitstringStatusList">
The <code>type</code> of the credential <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subject</a>, which is the
status list, <em class="rfc2119">MUST</em> be <code>BitstringStatusList</code>.
              </td>
            </tr>
            <tr>
              <td id="statusPurpose">credentialSubject.statusPurpose</td>
              <td>
The value of the purpose property of the status entry, <code>statusPurpose</code>, <em class="rfc2119">MUST</em> be
one or more strings. While the value of each string is arbitrary, the following
values <em class="rfc2119">MUST</em> be used for their intended purpose:
                <table class="simple">
                  <thead>
                    <tr>
                      <th style="white-space: nowrap">Value</th>
                      <th>Description</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><code>refresh</code></td>
                      <td>
Used to signal that an updated <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> is available via the
credential's <a href="https://www.w3.org/TR/vc-data-model-2.0/#refreshing">refresh service</a>
feature. This status does not invalidate the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> and is not reversible.
                      </td>
                    </tr>
                    <tr>
                      <td><code>revocation</code></td>
                      <td>
Used to cancel the validity of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>. This status is
not reversible.
                      </td>
                    </tr>
                    <tr>
                      <td><code>suspension</code></td>
                      <td>
Used to temporarily prevent the acceptance of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
This status is reversible.
                      </td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td id="encodedList">credentialSubject.encodedList</td>
              <td>
The <code>encodedList</code> property of the credential <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subject</a> <em class="rfc2119">MUST</em> be a
<a href="https://www.w3.org/TR/vc-data-integrity/#multibase-0">Multibase-encoded base64url (with
no padding)</a> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc4648" title="The Base16, Base32, and Base64 Data Encodings">RFC4648</a></cite>] representation of the GZIP-compressed [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1952" title="GZIP file format specification version 4.3">RFC1952</a></cite>]
bitstring values for the associated range of <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
status values. The uncompressed bitstring <em class="rfc2119">MUST</em> be at least 16KB in size. The
bitstring <em class="rfc2119">MUST</em> be encoded such that the first index, with a value of zero (<code>0</code>),
is located at the left-most bit in the bitstring and the last index, with a
value of one less than the length of the bitstring (<code>bitstring_length - 1</code>), is
located at the right-most bit in the bitstring. Further information on bitstring
encoding can be found in Section <a href="#bitstring-encoding" class="sec-ref"><bdi class="secno">7.1 </bdi>Bitstring Encoding</a>.
              </td>
            </tr>
            <tr>
              <td id="ttl">credentialSubject.ttl</td>
              <td>
The <code>ttl</code> is an <em class="rfc2119">OPTIONAL</em> property that indicates the "time to live" in
milliseconds before a refresh <em class="rfc2119">SHOULD</em> be attempted. If not present, no default
value is assumed. The value does not override or replace the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#validity-period">validity period</a>
of the <code>BitstringStatusList</code>. Implementations that publish the status list
<em class="rfc2119">SHOULD</em> align any protocol-specific caching information, such as the HTTP
<code>Cache-Control</code> header, with the value in this field.
              </td>
            </tr>
          </tbody>
        </table>

        <p>
The example below demonstrates how the <code>BitstringStatusListEntry</code> is used
with a <code>BitstringStatusListCredential</code> to provide the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> with
the information necessary to determine the status of a particular
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
        </p>

        <div class="example" id="example-example-bitstringstatuslistcredential">
        <div class="marker">
    <a class="self-link" href="#example-example-bitstringstatuslistcredential">Example<bdi> 2</bdi></a><span class="example-title">: Example BitstringStatusListCredential</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2"
  ],
  "id": "<span class="highlight">https://example.com/credentials/status/3</span>",
  "type": ["VerifiableCredential", "<span class="highlight">BitstringStatusListCredential</span>"],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "<span class="highlight">BitstringStatusList</span>",
    "statusPurpose": "<span class="highlight">revocation</span>",
    "encodedList": "<span class="highlight">uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA</span>"
  }
}</pre>
      </div>

      </section>
    </section>
  

  <section class="normative" id="algorithms"><div class="header-wrapper"><h2 id="x3-algorithms"><bdi class="secno">3. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3."></a></div>
    

    <p>
The following section outlines the algorithms that are used to generate
and validate status lists as described by this document.
    </p>

    <p>
If an implementation of any of the algorithms in this section processes a property
defined in Section <a href="#data-model" class="sec-ref"><bdi class="secno">2. </bdi>Data Model</a> whose value is malformed due to
not complying with associated "<em class="rfc2119">MUST</em>" statements, a
<a href="https://www.w3.org/TR/vc-data-model-2.0/#MALFORMED_VALUE_ERROR">MALFORMED_VALUE_ERROR</a>
<em class="rfc2119">MUST</em> be raised.
    </p>

    <section class="normative" id="generate-algorithm"><div class="header-wrapper"><h3 id="x3-1-generate-algorithm"><bdi class="secno">3.1 </bdi>Generate Algorithm</h3><a class="self-link" href="#generate-algorithm" aria-label="Permalink for Section 3.1"></a></div>
      

      <p>
The following process, or one generating the exact output, <em class="rfc2119">MUST</em> be followed
when producing a
<a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>.
The algorithm takes a list of <var>issued credentials</var> as input and either throws
an error or returns a status list credential as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>issued credentials</var> be a list of all issued
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>.
        </li>
        <li>
Let <var>statusListCredential</var> be an unsigned
<a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>
without the <code>encodedList</code> property set.
        </li>
        <li>
Generate a <var>compressed bitstring</var> by passing
<var>issued credentials</var> to the
<a href="#bitstring-generation-algorithm">Bitstring Generation Algorithm</a>.
        </li>
        <li>
Set the <code>encodedList</code> to <var>compressed bitstring</var>.
        </li>
        <li>
Generate a proof for the <var>statusListCredential</var> and publish it to the
endpoint listed in the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
        </li>
      </ol>

      <p>
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuers</a> <em class="rfc2119">SHOULD</em> publish status list credentials in a way that can be cached
and that does not track who retrieves the status list credential, such as
through <cite><a data-matched-text="[[[RFC9458]]]" href="https://www.rfc-editor.org/rfc/rfc9458">Oblivious HTTP</a></cite>, a content distribution network that is not operated by
the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>, or business processes for which the access logs are not
accessible by data analysts or systems administrators.
      </p>

    </section>

    <section class="normative" id="validate-algorithm"><div class="header-wrapper"><h3 id="x3-2-validate-algorithm"><bdi class="secno">3.2 </bdi>Validate Algorithm</h3><a class="self-link" href="#validate-algorithm" aria-label="Permalink for Section 3.2"></a></div>
      

      <p>
The following process, or one generating the exact output, <em class="rfc2119">MUST</em> be followed
when validating a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that is contained in a
<a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>.
The algorithm takes a status list <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> as input
and either throws an error or returns a status list credential as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>credentialToValidate</var> be a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
containing a <code>credentialStatus</code> entry that is a
<a href="#bitstringstatuslistentry">BitstringStatusListEntry</a>.
        </li>
        <li>
Let <var>minimumNumberOfEntries</var> be 131,072 unless a different lower bound is
established by a specific ecosystem specification.
        </li>
        <li>
Let <var>status purpose</var> be the value of <code>statusPurpose</code>
in the <code>credentialStatus</code> entry in the
<var>credentialToValidate</var>.
        </li>
        <li>
Dereference the <code>statusListCredential</code> URL, and ensure that all
proofs verify successfully. If the dereference fails, raise a
<a href="#STATUS_RETRIEVAL_ERROR">STATUS_RETRIEVAL_ERROR</a>. If any of the
proof verifications fail, raise a
<a href="#STATUS_VERIFICATION_ERROR">STATUS_VERIFICATION_ERROR</a>.
        </li>
        <li>
Verify that the <var>status purpose</var> is equal to a <code>statusPurpose</code> value in the
<var>statusListCredential</var>. Note: The <var>statusListCredential</var> might contain multiple
status purposes in a single list. If the values are not
equal, raise a
<a href="#STATUS_VERIFICATION_ERROR">STATUS_VERIFICATION_ERROR</a>.
        </li>
        <li>
Let <var>compressed bitstring</var> be the value of the
<code>encodedList</code> property of the
<a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>.
        </li>
        <li>
Let <var>credentialIndex</var> be the value of the
<code>statusListIndex</code> property of the
<a href="#bitstringstatuslistentry">BitstringStatusListEntry</a>.
        </li>
        <li>
Generate a <var>revocation bitstring</var> by passing
<var>compressed bitstring</var> to the
<a href="#bitstring-expansion-algorithm">Bitstring Expansion Algorithm</a>.
        </li>
        <li>
If the length of the <var>revocation bitstring</var> is less than
<var>minimumNumberOfEntries</var>, raise a
<a href="#STATUS_LIST_LENGTH_ERROR">STATUS_LIST_LENGTH_ERROR</a>.
        </li>
        <li>
Let <var>status</var> be the value in the <var>bitstring</var> at the position indicated
by the <var>credentialIndex</var> multiplied by the <var>size</var>. If the <var>credentialIndex</var>
multiplied by the <var>size</var> is a value outside of the range of the <var>bitstring</var>, a
<a href="https://www.w3.org/TR/vc-data-model-2.0/#RANGE_ERROR">RANGE_ERROR</a> <em class="rfc2119">MUST</em> be
raised.
        </li>
        <li>
Let <var>result</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>.
        </li>
        <li>
Set the <code>status</code> key in <var>result</var> to <var>status</var>, and set the <code>purpose</code> key in
<var>result</var> to the value of <code>statusPurpose</code>.
        </li>
        <li>
If <var>status</var> is <code>0</code>, set the <code>valid</code> key in <var>result</var> to <code>true</code>; otherwise, set it
to <code>false</code>.
        </li>
        <li>
Return <var>result</var>.
        </li>
      </ol>

      <p>
When a <code>statusListCredential</code> URL is dereferenced, server implementations <em class="rfc2119">MAY</em>
provide a mechanism to dereference the status list as of a particular point in
time. When an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> provides such a mechanism, it enables a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> to determine changes in status to a precision chosen by the
issuer, such as hourly, daily, or weekly. If such a feature is supported, and if
query parameters are supported by the URL scheme, then the name of the query
parameter <em class="rfc2119">MUST</em> be <code>timestamp</code> and the value <em class="rfc2119">MUST</em> be a valid URL-encoded
[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] dateTimeStamp string value. The result of dereferencing such a
timestamp-parameterized URL <em class="rfc2119">MUST</em> be either a status list credential containing
the status list as it existed at the given point in time, or a
<a href="#STATUS_RETRIEVAL_ERROR">STATUS_RETRIEVAL_ERROR</a>. If the result is
an error, implementations <em class="rfc2119">MAY</em> attempt the retrieval again with a different
timestamp value, or without a timestamp value, as long as the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>'s
validation rules permit such an action.
      </p>

      <p>
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">Verifiers</a> <em class="rfc2119">SHOULD</em> cache the retrieved status list and <em class="rfc2119">SHOULD</em> use proxies
or other mechanisms, such as <cite><a data-matched-text="[[[RFC9458]]]" href="https://www.rfc-editor.org/rfc/rfc9458">Oblivious HTTP</a></cite>, that hide retrieval behavior from
the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>.
      </p>

      <div class="note" role="note" id="issue-container-generatedID-1"><div role="heading" class="note-title marker" id="h-note-1" aria-level="4"><span>Note</span><span class="issue-label">: Issuer validation is use case dependent</span></div><p class="">
It is expected that a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> will ensure that it trusts the issuer
of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>, as well as the issuer of the associated
<a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>,
before using the information contained in either credential for further
decision making purposes. Implementers are advised that the issuers of these
credential might differ, such as when the original issuer of the
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> does not maintain a record of its validity.
      </p></div>

    </section>

    <section class="normative" id="bitstring-generation-algorithm"><div class="header-wrapper"><h3 id="x3-3-bitstring-generation-algorithm"><bdi class="secno">3.3 </bdi>Bitstring Generation Algorithm</h3><a class="self-link" href="#bitstring-generation-algorithm" aria-label="Permalink for Section 3.3"></a></div>
      
      <p>
The following process, or one generating the exact output, <em class="rfc2119">MUST</em> be followed
when generating a status list bitstring. The algorithm takes an
<var>issuedCredentials</var> list as input and either throws an error or returns a
<var>compressed bitstring</var> as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>bitstring</var> be a list of bits with a minimum size of 16KB,
where each bit is initialized to 0 (zero).
        </li>
        <li>
For each value in <code>bitstring</code>, if there is a corresponding <code>statusListIndex</code>
value in a credential in <code>issuedCredentials</code>, set the value to the appropriate
status.
        </li>
        <li>
Generate a <var>compressed bitstring</var> by using the GZIP
compression algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1952" title="GZIP file format specification version 4.3">RFC1952</a></cite>] on the <var>bitstring</var>
and then <a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase-encode</a> the result using base64url (with no padding).
        </li>
        <li>
Return the <var>compressed bitstring</var>.
        </li>
      </ol>
    </section>

    <section class="normative" id="bitstring-expansion-algorithm"><div class="header-wrapper"><h3 id="x3-4-bitstring-expansion-algorithm"><bdi class="secno">3.4 </bdi>Bitstring Expansion Algorithm</h3><a class="self-link" href="#bitstring-expansion-algorithm" aria-label="Permalink for Section 3.4"></a></div>
      

      <p>
The following process, or one generating the exact output, <em class="rfc2119">MUST</em> be followed
when expanding a compressed status list bitstring. The algorithm takes a
<var>compressed bitstring</var> as input and either throws an error or returns a
<var>uncompressed bitstring</var> as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>compressed bitstring</var> be a compressed status list
bitstring.
        </li>
        <li>
Generate an <var>uncompressed bitstring</var> by using the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase-decode</a> algorithm on the
<var>compressed bitstring</var> and then expanding the output using
the GZIP decompression algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc1952" title="GZIP file format specification version 4.3">RFC1952</a></cite>].
        </li>
        <li>
Return the <var>uncompressed bitstring</var>.
        </li>
      </ol>
    </section>

    <section class="normative" id="processing-errors"><div class="header-wrapper"><h3 id="x3-5-processing-errors"><bdi class="secno">3.5 </bdi>Processing Errors</h3><a class="self-link" href="#processing-errors" aria-label="Permalink for Section 3.5"></a></div>
      

      <p>
The algorithms described in this specification throw specific types of errors.
Implementers might find it useful to convey these errors to other libraries or
software systems. This section provides specific URLs, descriptions, and error
codes for the errors, such that an ecosystem implementing technologies described
by this specification might interoperate more effectively when errors occur.
      </p>

      <p>
When exposing these errors through an HTTP interface, implementers <em class="rfc2119">SHOULD</em> use
<cite><a data-matched-text="[[[RFC9457]]]" href="https://www.rfc-editor.org/rfc/rfc9457">Problem Details for HTTP APIs</a></cite> [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9457" title="Problem Details for HTTP APIs">RFC9457</a></cite>] to encode the error data structure. If [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc9457" title="Problem Details for HTTP APIs">RFC9457</a></cite>] is
used:
      </p>

      <ul>
        <li>
The <code>type</code> value of the error object <em class="rfc2119">MUST</em> be a URL that starts with the value
<code>https://www.w3.org/ns/credentials/status-list#</code> and ends with the value in the
section listed below.
        </li>
        <li>
The <code>title</code> value <em class="rfc2119">SHOULD</em> provide a short but specific human-readable string for
the error.
        </li>
        <li>
The <code>detail</code> value <em class="rfc2119">SHOULD</em> provide a longer human-readable string for the error.
        </li>
        <li>
All human-readable strings <em class="rfc2119">SHOULD</em> be localized as described in Section 1 of
<cite><a data-matched-text="[[[RFC9457]]]" href="https://www.rfc-editor.org/rfc/rfc9457">Problem Details for HTTP APIs</a></cite>, using <a data-link-type="dfn" href="https://www.w3.org/TR/i18n-glossary/#dfn-language-negotiation">language negotiation</a> through the <code>Accept-Language</code>
HTTP header field to select the most appropriate resources.
        </li>
      </ul>

      <dl>
        <dt id="STATUS_RETRIEVAL_ERROR">
STATUS_RETRIEVAL_ERROR
        </dt>
        <dd>
Retrieval of the status list failed. See Section
<a href="#validate-algorithm" class="sec-ref"><bdi class="secno">3.2 </bdi>Validate Algorithm</a>.
        </dd>
        <dt id="STATUS_VERIFICATION_ERROR">STATUS_VERIFICATION_ERROR</dt>
        <dd>
Validation of the status entry failed. See Section
<a href="#validate-algorithm" class="sec-ref"><bdi class="secno">3.2 </bdi>Validate Algorithm</a>.
        </dd>
        <dt id="STATUS_LIST_LENGTH_ERROR">
STATUS_LIST_LENGTH_ERROR
        </dt>
        <dd>
The status list length does not satisfy the minimum length required for
herd privacy. See Section <a href="#validate-algorithm" class="sec-ref"><bdi class="secno">3.2 </bdi>Validate Algorithm</a>.
        </dd>
      </dl>
    </section>
    <section class="normative" id="securing-algorithms"><div class="header-wrapper"><h3 id="x3-6-securing-algorithms"><bdi class="secno">3.6 </bdi>Securing Algorithms</h3><a class="self-link" href="#securing-algorithms" aria-label="Permalink for Section 3.6"></a></div>
      
      <p>
There are multiple ways that the information in Section
<a href="#data-model" class="sec-ref"><bdi class="secno">2. </bdi>Data Model</a> can be secured. These mechanisms are elaborated
upon in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#securing-mechanisms">Securing Mechanisms</a>
section of the <cite><a data-matched-text="[[[VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite>.
      </p>
      <p>
When securing a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that contains a reference to
a <a href="#bitstringstatuslistcredential">BitstringStatusListCredential</a>,
implementers <em class="rfc2119">SHOULD</em> use the same securing mechanism with the same
cryptographic parameters and the same media type for both
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>.
      </p>
    </section>

  </section>

  <section class="normative" id="media-types"><div class="header-wrapper"><h2 id="x4-media-types"><bdi class="secno">4. </bdi>Media Types</h2><a class="self-link" href="#media-types" aria-label="Permalink for Section 4."></a></div>
    

    <p>
When dereferencing <code>statusListCredential</code>, the content of the returned
<code>statusListCredential</code> might be any media type registered for the purpose of
expressing a verifiable credential with one or more proofs.
    </p>
    <p>
For example, a verifiable credential secured with Data Integrity Proofs might
have media type <code>application/vc</code>, while a verifiable credential
secured with SD-JWT might have media type <code>application/sd-jwt</code>.
    </p>
    <p>
Some implementations might choose to support less specific media types such as
<code>application/ld+json</code> or <code>application/json</code>.
    </p>
    <p>
When dereferencing over HTTP, the use of the
<a href="https://httpwg.org/specs/rfc7231.html#rfc.section.5.3.2">accept</a> and
<a href="https://httpwg.org/specs/rfc7231.html#rfc.section.3.1.1.5">content-type</a> headers, might
allow some implementations to negotiate for the proof format used to secure the
<code>statusListCredential</code>.
    </p>
    <p>
Some implementations might use the
<a href="https://httpwg.org/specs/rfc7231.html#rfc.section.6.5.13">415 Unsupported Media Type</a> status
code to signal that they do not support the requested media type.
    </p>
  </section>

  <section id="contexts-and-vocabularies"><div class="header-wrapper"><h2 id="x5-contexts-and-vocabularies"><bdi class="secno">5. </bdi>Contexts and Vocabularies</h2><a class="self-link" href="#contexts-and-vocabularies" aria-label="Permalink for Section 5."></a></div>
    

    <section id="vocabulary"><div class="header-wrapper"><h3 id="x5-1-vocabulary"><bdi class="secno">5.1 </bdi>Vocabulary</h3><a class="self-link" href="#vocabulary" aria-label="Permalink for Section 5.1"></a></div>
      
      <p>
The terms defined in this specification are also part of the RDF <a href="https://www.w3.org/TR/rdf-concepts/#vocabularies">vocabulary namespace</a>
<a href="https://www.w3.org/ns/credentials/status">https://www.w3.org/ns/credentials/status#</a>. For any
<code>TERM</code>, the relevant URL is of the form <code>https://www.w3.org/ns/credentials/status#TERM</code>.
Implementations that use RDF processing and rely on this specification <em class="rfc2119">MUST</em> use
these URLs.
      </p>

      <p>
When dereferencing the
<a href="https://www.w3.org/ns/credentials/status">https://www.w3.org/ns/credentials/status#</a> URL, the
media type of the data that is returned depends on HTTP content negotiation.
These are as follows:
      </p>

      <table class="simple">
        <thead>
          <tr>
            <th>Media Type</th>
            <th>Description and Hash</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
application/ld+json
            </td>
            <td>
The vocabulary in JSON-LD format [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld11" title="JSON-LD 1.1">JSON-LD11</a></cite>].<br>

<strong>SHA2-256 Digest:</strong>
<code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-bitstring-status-list/vocab/vocabulary.jsonld" data-hash-format="openssl dgst -sha256">b9434542c4a45e5e13e23274737855715eb6a32a6d65eaecc0eeaddedfbecac3</span></code>
            </td>
          </tr>
          <tr>
            <td>
text/turtle
            </td>
            <td>
The vocabulary in Turtle format [<cite><a class="bibref" data-link-type="biblio" href="#bib-turtle" title="RDF 1.1 Turtle">TURTLE</a></cite>].<br>

<strong>SHA2-256 Digest:</strong>
<code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-bitstring-status-list/vocab/vocabulary.ttl" data-hash-format="openssl dgst -sha256">da5c3ef7d09d042a988e59f98e7adc403577935f91175bb0736bcff3cd26d834</span></code>
            </td>
          </tr>
          <tr>
            <td>
text/html
            </td>
            <td>
The vocabulary in HTML+RDFa Format [<cite><a class="bibref" data-link-type="biblio" href="#bib-html-rdfa" title="HTML+RDFa 1.1 - Second Edition">HTML-RDFA</a></cite>].<br>


<strong>SHA2-256 Digest:</strong>
<code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-bitstring-status-list/vocab/vocabulary.html" data-hash-format="openssl dgst -sha256">2272e01bd93dedb70272f071b9955fe0856b98ee408f3edcbf048f3b469873dd</span></code>
            </td>
          </tr>
        </tbody>
      </table>

      <p>
It is possible to confirm the cryptographic digests above by running a command
like the following (replacing <code>&lt;MEDIA_TYPE&gt;</code> and <code>&lt;DOCUMENT_URL&gt;</code> with the
appropriate values) through a modern UNIX-like OS command line interface:
<code>curl -sL -H "Accept: &lt;MEDIA_TYPE&gt;" &lt;DOCUMENT_URL&gt; | openssl dgst -sha256</code>
      </p>
    </section>

    <section id="json-ld-context"><div class="header-wrapper"><h3 id="x5-2-json-ld-context"><bdi class="secno">5.2 </bdi>JSON-LD context</h3><a class="self-link" href="#json-ld-context" aria-label="Permalink for Section 5.2"></a></div>
      
      <p>
Implementations that perform JSON-LD processing <em class="rfc2119">MUST</em> treat the following JSON-LD
context URL as already resolved, where the resolved document matches the
corresponding hash value below:
      </p>

      <table class="simple">
        <thead>
          <tr><th>Context URL and Hash</th>
        </tr></thead>
        <tbody>
          <tr>
            <td style="white-space: nowrap;">
<strong>URL:</strong> https://www.w3.org/ns/credentials/status/v1<br>
<strong>SHA2-256 Digest:</strong><br>
<code><span class="vc-hash" data-hash-url="https://w3c.github.io/vc-bitstring-status-list/contexts/v1.jsonld" data-hash-format="openssl dgst -sha256">22ce92d65121ebc55b27592ce1eb2336ab60a30950fbc624ae827e6e50bb6a44</span></code>
            </td>
          </tr>
        </tbody>
      </table>

      <p>
It is possible to confirm the cryptographic digests listed above by running a
command like the following through a modern UNIX-like OS command line interface:
<code>curl -sL -H "Accept: application/ld+json" https://www.w3.org/ns/credentials/status/v1 | openssl dgst -sha256</code>
      </p>

      <p>
The vocabulary terms that the JSON-LD contexts resolve to
are in the <a href="https://www.w3.org/ns/credentials/status">https://www.w3.org/ns/credentials/status#</a>
namespace. See Section <a href="#vocabulary" data-matched-text="[[[#vocabulary]]]" class="sec-ref"><bdi class="secno">5.1 </bdi>Vocabulary</a> for further details.
      </p>

      <div class="note" role="note" id="issue-container-generatedID-2"><div role="heading" class="note-title marker" id="h-note-2" aria-level="4"><span>Note</span></div><p class="">
Applications or specifications may define mappings to the vocabulary URLs using
their own JSON-LD contexts. For example, the JSON-LD context definitions
referred to in this section are also a part of the
<code>https://www.w3.org/ns/credentials/v2</code> context, defined by the
<cite><a data-matched-text="[[[?VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite> specification.
      </p></div>
    </section>
  </section>

  <section class="informative" id="privacy-considerations"><div class="header-wrapper"><h2 id="x6-privacy-considerations"><bdi class="secno">6. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 6."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
This section details the general privacy considerations and specific privacy
implications of deploying this specification into production environments.
    </p>

    <p>
Readers are urged to familiarize themselves with the general
privacy advice provided in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#privacy-considerations">
Privacy Considerations section of the Verifiable Credentials
specification</a> before reading this section.
    </p>

    <section class="informative" id="revocation-bitstring-length"><div class="header-wrapper"><h3 id="x6-1-revocation-bitstring-length"><bdi class="secno">6.1 </bdi>Revocation Bitstring Length</h3><a class="self-link" href="#revocation-bitstring-length" aria-label="Permalink for Section 6.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
This document specifies a minimum revocation bitstring length of 131,072, or
16KB uncompressed. This is enough to give <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a> an adequate amount of
group privacy if the number of verifiable credentials issued is large enough.
However, if the number of issued verifiable credentials is a small population,
the ability to correlate an individual increases because the number of allocated
slots in the bitstring is small. Correlating this information with, for example,
where the geographic request came from can also help to correlate individuals
that have received a credential from the same geographic region.
      </p>
    </section>

    <section class="informative" id="unnecessary-correlation"><div class="header-wrapper"><h3 id="x6-2-unnecessary-correlation"><bdi class="secno">6.2 </bdi>Unnecessary Correlation</h3><a class="self-link" href="#unnecessary-correlation" aria-label="Permalink for Section 6.2"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
There are a number of global identifiers used in a status list entry, defined in
Section <a href="#bitstringstatuslistentry" data-matched-text="[[[#bitstringstatuslistentry]]]" class="sec-ref"><bdi class="secno">2.1 </bdi>BitstringStatusListEntry</a>, that can be used across <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a>
to correlate <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subjects</a>. Some of the properties that can
express these values are <code>id</code>, <code>statusListIndex</code>, and
<code>statusListCredential</code>.
      </p>

      <p>
In some cases, such as when <a data-link-type="dfn" data-lt="presentations" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-presentation">presenting</a> a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> that contains a global identifier (such as a driver's license
identification number), adding one or more global identifier(s) for status list
information does not increase correlation harm, since a single globally unique
identifier is all that is required for correlation.
      </p>

      <p>
When global identifiers are used in <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-presentation">presentations</a> that use
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-selective-disclosure">selective disclosure</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-unlinkable-disclosure">unlinkable disclosure</a>, they can violate privacy
expectations. <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuers</a> are urged to enable status information to be
selectively disclosable/concealable when a particular <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
is expected to be disclosed in a way that does not need correlation, such as when
proving that an individual is above a certain age. <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">Verifiers</a> can require
that status information be revealed in situations that require them to know the
current status of a credential, and the holder might then consent or refuse to
reveal that information for a given transaction. In all cases, both <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuers</a>
and <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a> are urged to avoid the use of global identifiers in order to
prevent correlation, unless it is required for or by a particular exchange.
      </p>

      <p>
For information on other types of potential correlation,
readers are urged to study the Privacy Considerations section of the
<cite><a data-matched-text="[[[VC-DATA-MODEL-2.0]]]" href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a></cite> specification, particularly the subsections on
<a href="https://www.w3.org/TR/vc-data-model-2.0/#identifier-based-correlation">
Identifier-Based Correlation</a>,
<a href="https://www.w3.org/TR/vc-data-model-2.0/#signature-based-correlation">
Signature-Based Correlation</a>,
<a href="https://www.w3.org/TR/vc-data-model-2.0/#identifier-based-correlation">
Long-Lived-Identifier-Based Correlation</a>, and
<a href="https://www.w3.org/TR/vc-data-model-2.0/#metadata-based-correlation">
Metadata-Based Correlation</a>.
      </p>

    </section>

    <section class="informative" id="verifier-caching"><div class="header-wrapper"><h3 id="x6-3-verifier-caching"><bdi class="secno">6.3 </bdi>Verifier Caching</h3><a class="self-link" href="#verifier-caching" aria-label="Permalink for Section 6.3"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
It is possible for <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a> to increase the privacy of the
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> whose <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> is being checked by caching
status lists that have been fetched from remote servers. By caching the
content locally, less correlatable information can be inferred from
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>-based access patterns on the status list.
      </p>
    </section>

    <section class="informative" id="content-distribution-networks"><div class="header-wrapper"><h3 id="x6-4-content-distribution-networks"><bdi class="secno">6.4 </bdi>Content Distribution Networks</h3><a class="self-link" href="#content-distribution-networks" aria-label="Permalink for Section 6.4"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
The use of content distribution networks by <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuers</a> can increase the
privacy of <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a> by reducing or eliminating requests for the
status lists from the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>. Often, a request for a revocation
list will be served by an edge device and thus be faster and reduce the load
on the server as well as cloaking <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a>
from <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuers</a>.
      </p>
    </section>

    <section class="informative" id="decoy-values"><div class="header-wrapper"><h3 id="x6-5-decoy-values"><bdi class="secno">6.5 </bdi>Decoy Values</h3><a class="self-link" href="#decoy-values" aria-label="Permalink for Section 6.5"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuer</a> use of decoy values in status lists has been explored as a mechanism
to increase the privacy of <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subjects</a>. While algorithms for employing decoy
values are out of scope for this specification, implementers are advised that
the use of decoy values can harm privacy if the decoy values do not accurately
simulate the population associated with the status list. If decoy values can
be distinguished from real values, the anonymity provided in the set will be
reduced by the number of decoy values that are detectable as such. The most
privacy-preserving status list is one that never changes, since the behavior
of the population cannot be determined if no observable events occur.
      </p>
      <p>
Given how difficult it is to statistically simulate status entries for
a population, and that general advice cannot be given since
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a> serve a broad set of use cases, implementers
are advised to allocate status list entry indexes randomly, and to minimize —
optimally to never — the rate at which status entries are changed. Allocation
of status list entries preserves privacy best when it does not trigger any
observable change of a status list.
      </p>
    </section>

    <section class="informative" id="malicious-issuers-and-verifiers"><div class="header-wrapper"><h3 id="x6-6-malicious-issuers-and-verifiers"><bdi class="secno">6.6 </bdi>Malicious Issuers and Verifiers</h3><a class="self-link" href="#malicious-issuers-and-verifiers" aria-label="Permalink for Section 6.6"></a></div><p><em>This section is non-normative.</em></p>
      
      <p>
In general, the group privacy protections offered by this specification can be
circumvented by malicious <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuers</a> and <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifiers</a>. Its privacy
benefits can only be realized when issuers and verifiers intend to avoid
tracking or sharing the presentation of particular credentials.
      </p>
      <p>
A malicious <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> might intentionally attack group privacy by sharing
information from presented credentials with a malicious <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a>. This
sort of collusion is difficult to detect as it is typically performed via a
secure communication channel between the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> and the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>.
      </p>
      <p>
A malicious <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> might intentionally attack group privacy by creating a
unique status list for each issued credential, in order to establish a one-to-one
mapping to track when a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> processes each mapped credential. Similarly,
they could establish a one-to-one mapping by using a different
cryptographic key for each issued credential that is tracked by a given status list.
      </p>
      <p>
This sort of collusion can be detected by <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> software that serves
multiple <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a> (e.g., a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> app that runs on a server) if it
has, for example, an opt-in process that finds that some global identifier(s)
used within a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> are not adequately shared by other
credentials.
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">Holders</a> could then be warned when presenting a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>
that contains some global identifier(s) that are unique to that credential.
Such an opt-in service could represent some additional privacy concerns;
whether this potential exposure via the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> software is justified by
the awareness of possible global identifier correlation can only be evaluated
by the users of such a system.
      </p>
    </section>

    <section class="informative" id="monitoring-status-lists"><div class="header-wrapper"><h3 id="x6-7-monitoring-status-lists"><bdi class="secno">6.7 </bdi>Monitoring Status Lists</h3><a class="self-link" href="#monitoring-status-lists" aria-label="Permalink for Section 6.7"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
Once a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> knows of a status list and entry index that is
associated with a specific <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subject</a>, it becomes possible for that
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> to see updates to that status entry as long as the
status list continues to be updated. This is useful to a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> that
needs to understand when a particular <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> has changed
status without asking the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> directly for status information on
the specific <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> or when interacting with the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> to get
the latest status information is not possible. The feature can also cause a
privacy violation for the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holder</a> and/or <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-subjects">subject</a> if the
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> is able to perform near-real-time checks on the status of the
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
      </p>

      <p>
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuers</a> can provide a level of reprieve from this privacy concern for
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-holders">holders</a> by revoking and reissuing effectively the same
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> on a relatively brief timeline.
For example, an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> could automatically reissue a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> every three months and assign a new status entry
index when the reissuance occurs to break any sort of long-term monitoring
of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> as it changes status.
      </p>

    </section>

  </section>

  <section class="informative" id="security-considerations"><div class="header-wrapper"><h2 id="x7-security-considerations"><bdi class="secno">7. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 7."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
There are a number of security considerations that implementers should be
aware of when processing data described by this specification. Ignoring or
not understanding the implications of this section can result in
security vulnerabilities.
    </p>

    <p>
Readers are urged to familiarize themselves with the general
security advice provided in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#security-considerations">
Security Considerations section of the Verifiable Credentials
specification</a> before reading this section.
    </p>

    <p>
While this section attempts to highlight a broad set of security
considerations, it is not a complete list. Implementers are urged to seek the
advice of security and cryptography professionals when implementing mission
critical systems using the technology outlined in this specification.
    </p>

    <section class="informative" id="bitstring-encoding"><div class="header-wrapper"><h3 id="x7-1-bitstring-encoding"><bdi class="secno">7.1 </bdi>Bitstring Encoding</h3><a class="self-link" href="#bitstring-encoding" aria-label="Permalink for Section 7.1"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
It is critical that implementers pay particular attention to the way that they
encode and decode bitstrings. Failure to do so can result in checking the
wrong bitstring index for a given credential, leading to a misinterpretation
of its present state (e.g., mistaking a revoked status for an unrevoked
status). As stated in Section <a href="#bitstringstatuslistcredential" class="sec-ref"><bdi class="secno">2.2 </bdi>BitstringStatusListCredential</a>,
bitstrings are encoded such that the first (zeroth) index refers to the
left-most bit of the bitstring array. The diagram below demonstrates the
proper layout for an uncompressed bitstring.
      </p>

      <figure id="bitstring-layout">
        <img style="margin: auto; display: block; width: 75%;" src="diagrams/bitstring-layout.svg" alt="a diagram showing two
             wide rectangles shown side-by-side. Each rectangle is partitioned
             into eight boxes to represent the 8 bits in a byte. The left
             rectangle is labeled 'First byte' and the right rectangle is
             labeled 'Last byte'. The left rectangle's left-most bit box is
             pointed to by an arrow labeled 'index: 0'. The right rectangle's
             right-most bit box is pointed to by an arrow labeled
             'index: length - 1'.">
        <figcaption style="text-align: center;"><a class="self-link" href="#bitstring-layout">Figure <bdi class="figno">2</bdi></a> <span class="fig-title">
          A visual depiction of the bitstring layout.
        </span></figcaption>
      </figure>

      <p>
For example, if a bitstring is 131,072 bits in size (16KB), the first index will
be 0, and the last index will be 131,071.
      </p>
    </section>

    <section class="informative" id="validity-periods"><div class="header-wrapper"><h3 id="x7-2-validity-periods"><bdi class="secno">7.2 </bdi>Validity Periods</h3><a class="self-link" href="#validity-periods" aria-label="Permalink for Section 7.2"></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
The <a href="https://www.w3.org/TR/vc-data-model-2.0/#validity-period">validity period</a> that
an issuer might choose to express in a status list is dependent on a variety of
factors including:
      </p>
      <ul>
        <li>
How often do status values change? In real-time? Daily? Weekly? Monthly? Other?
        </li>
        <li>
Is there a regulatory requirement that compels an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> to notify a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> that the status of a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> has changed?
        </li>
        <li>
Is there a period of time after which an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> would incur reputational
damage by not notifying a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> of a status change?
        </li>
        <li>
Is there any expectation that a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a> will not accept a
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> with a status list that does not expire for a
period of time it deems excessive?
        </li>
        <li>
Will a short validity period for a status list cause a significant network
bandwidth or computing burden for an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> or a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifier">verifier</a>? Might
this burden be mitigated by a longer validity period?
        </li>
      </ul>

      <p>
Since these factors vary with the ecosystem and credential type, there is no
minimum or maximum validity period that is suggested for all status lists.
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">Issuers</a> will need to consider various factors that are specific to their
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a> types and choose validity periods that will strike
the right balance in their ecosystem.
      </p>
    </section>

  </section>

  <section class="informative" id="accessibility-considerations"><div class="header-wrapper"><h2 id="x8-accessibility-considerations"><bdi class="secno">8. </bdi>Accessibility Considerations</h2><a class="self-link" href="#accessibility-considerations" aria-label="Permalink for Section 8."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
Readers are urged to familiarize themselves with the general
accessibility advice provided in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#accessibility-considerations">
Accessibility Considerations section of the Verifiable Credentials
specification</a>. No further advice is provided in this specification beyond
the general advice for all <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>.
    </p>

  </section>

  <section class="informative" id="internationalization-considerations"><div class="header-wrapper"><h2 id="x9-internationalization-considerations"><bdi class="secno">9. </bdi>Internationalization Considerations</h2><a class="self-link" href="#internationalization-considerations" aria-label="Permalink for Section 9."></a></div><p><em>This section is non-normative.</em></p>
    

    <p>
Readers are urged to familiarize themselves with the general
internationalization advice provided in the
<a href="https://www.w3.org/TR/vc-data-model-2.0/#internationalization-considerations">
Internationalization Considerations section of the Verifiable Credentials
specification</a>. No further advice is provided in this specification beyond
the general advice for all <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credentials</a>.
    </p>

  </section>

  <section class="appendix informative" id="examples"><div class="header-wrapper"><h2 id="a-examples"><bdi class="secno">A. </bdi>Examples</h2><a class="self-link" href="#examples" aria-label="Permalink for Appendix A."></a></div><p><em>This section is non-normative.</em></p>
      

      <section id="revocable-verifiable-credential"><div class="header-wrapper"><h3 id="a-1-revocable-verifiable-credential"><bdi class="secno">A.1 </bdi>Revocable Verifiable Credential</h3><a class="self-link" href="#revocable-verifiable-credential" aria-label="Permalink for Appendix A.1"></a></div>
        
<div class="example" id="example-a-revocable-verifiable-credential">
        <div class="marker">
    <a class="self-link" href="#example-a-revocable-verifiable-credential">Example<bdi> 3</bdi></a><span class="example-title">: A Revocable Verifiable Credential</span>
  </div> 
      <div class="vc-tabbed"><input type="radio" id="vc-tab1unsigned" name="vc-tabs1" checked=""><input type="radio" id="vc-tab1ecdsa-rdfc-2019" name="vc-tabs1"><input type="radio" id="vc-tab1eddsa-rdfc-2022" name="vc-tabs1"><input type="radio" id="vc-tab1jose" name="vc-tabs1"><input type="radio" id="vc-tab1cose" name="vc-tabs1"><ul class="vc-tabs"><li class="vc-tab"><label for="vc-tab1unsigned"><abbr title="Unsecured credential">Credential</abbr></label></li><li class="vc-tab"><label for="vc-tab1ecdsa-rdfc-2019"><abbr title="Secured with Data Integrity - ecdsa-rdfc-2019">ecdsa</abbr></label></li><li class="vc-tab"><label for="vc-tab1eddsa-rdfc-2022"><abbr title="Secured with Data Integrity - eddsa-rdfc-2022">eddsa</abbr></label></li><li class="vc-tab"><label for="vc-tab1jose"><abbr title="Secured with JOSE">jose</abbr></label></li><li class="vc-tab"><label for="vc-tab1cose"><abbr title="Secured with COSE">cose</abbr></label></li></ul><div class="vc-tab-content" style="min-height: 454px;"><pre class="nohighlight vc" data-vc-vm="https://example.edu/issuers/565049/keys/1" data-vc-tabs="ecdsa-rdfc-2019 eddsa-rdfc-2022 jose cose">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": ["VerifiableCredential"],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:42Z",
  <span class="highlight">"credentialStatus": {
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  }</span>,
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 454px;"><strong>application/vc</strong>
            <pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": [
    "VerifiableCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:42Z",
  "credentialStatus": {
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  },
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "created": "2025-02-23T18:04:37Z",
    "verificationMethod": "did:key:zDnaeYANR4Bey6DhjY5uF7d1k3EXaWTKqVDz7a1jhgqSGfhjc",
    "cryptosuite": "ecdsa-rdfc-2019",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4Y8hfyQ68KuiVbMeBwnExsWuthJD7wcR7B5uGax165tpPcVuRfdWTQMyCLPDdubhjfmy3XYdCowTkFtjCGEbHdDD"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 454px;"><strong>application/vc</strong>
            <pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": [
    "VerifiableCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:42Z",
  "credentialStatus": {
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  },
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "created": "2025-02-23T18:04:37Z",
    "verificationMethod": "did:key:z6Mkkicdg7gYwr1kU8M2gxC1GgLBVGvYbepeu1dMatdq5naq",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5Kg5h7uAme1rWYbLsJTQBL1DRBUceyQjGckmUp86EDkwSwUrxhTTp5NgxqeCgtnnbEssLvQCnBHGWUktMDerhvEn"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 454px;">
<div class="vc-jose-cose-jwt-tabbed">
    <div class="vc-jose-cose-jwt-tab-content">
<strong>Protected Headers</strong>
<pre>{
  "kid": "ExHkBMW9fmbkvV266mRpuP2sUY_N_EWIN1lapUzO8ro",
  "alg": "ES256"
}
</pre>
<strong>application/vc</strong>
<pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": [
    "VerifiableCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:42Z",
  "credentialStatus": {
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  },
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  }
}
</pre>
<strong>application/vc+jwt</strong>
<div class="jose-text">
<div class="jwt-compact">
<span class="jwt-header">eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMyNTYifQ</span>
.<span class="jwt-payload">eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaWQiOiJodHRwczovL2V4YW1wbGUuY29tL2NyZWRlbnRpYWxzLzIzODk0NjcyMzk0IiwidHlwZSI6WyJWZXJpZmlhYmxlQ3JlZGVudGlhbCJdLCJpc3N1ZXIiOiJkaWQ6ZXhhbXBsZToxMjM0NSIsInZhbGlkRnJvbSI6IjIwMjEtMDQtMDVUMTQ6Mjc6NDJaIiwiY3JlZGVudGlhbFN0YXR1cyI6eyJpZCI6Imh0dHBzOi8vZXhhbXBsZS5jb20vY3JlZGVudGlhbHMvc3RhdHVzLzMjOTQ1NjciLCJ0eXBlIjoiQml0c3RyaW5nU3RhdHVzTGlzdEVudHJ5Iiwic3RhdHVzUHVycG9zZSI6InJldm9jYXRpb24iLCJzdGF0dXNMaXN0SW5kZXgiOiI5NDU2NyIsInN0YXR1c0xpc3RDcmVkZW50aWFsIjoiaHR0cHM6Ly9leGFtcGxlLmNvbS9jcmVkZW50aWFscy9zdGF0dXMvMyJ9LCJjcmVkZW50aWFsU3ViamVjdCI6eyJpZCI6ImRpZDpleGFtcGxlOjY3ODkiLCJ0eXBlIjoiUGVyc29uIn19</span>
.<span class="jwt-signature">BrrfRxFL61-U8-uqA4Rn1mhwIuHcSbVp5m2raoNeXtAYWs-2U2TCo1XCdX6i3-biYlVlpHlkRrBWb4skfJe6ng</span>
</div>
</div>
    </div>
</div></div><div class="vc-tab-content" style="min-height: 454px;">
<div class="vc-jose-cose-cose-tabbed">
    <div class="vc-jose-cose-cose-tab-content">
<strong>application/vc</strong>
<pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": [
    "VerifiableCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:42Z",
  "credentialStatus": {
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  },
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  }
}
</pre>
<strong>application/vc+cose</strong>
<div class="cose-text">
d28444a1013822a059021c7b2240636f6e74657874223a5b2268747470733a2f2f7777772e77332e6f72672f6e732f63726564656e7469616c732f7632222c2268747470733a2f2f7777772e77332e6f72672f6e732f63726564656e7469616c732f6578616d706c65732f7632225d2c226964223a2268747470733a2f2f6578616d706c652e636f6d2f63726564656e7469616c732f3233383934363732333934222c2274797065223a5b2256657269666961626c6543726564656e7469616c225d2c22697373756572223a226469643a6578616d706c653a3132333435222c2276616c696446726f6d223a22323032312d30342d30355431343a32373a34325a222c2263726564656e7469616c537461747573223a7b226964223a2268747470733a2f2f6578616d706c652e636f6d2f63726564656e7469616c732f7374617475732f33233934353637222c2274797065223a22426974737472696e675374617475734c697374456e747279222c22737461747573507572706f7365223a227265766f636174696f6e222c227374617475734c697374496e646578223a223934353637222c227374617475734c69737443726564656e7469616c223a2268747470733a2f2f6578616d706c652e636f6d2f63726564656e7469616c732f7374617475732f33227d2c2263726564656e7469616c5375626a656374223a7b226964223a226469643a6578616d706c653a36373839222c2274797065223a22506572736f6e227d7d5840e247d9a3e07c681c8ceae4224a48edbdd2bdc0ba25d0f50cb53b5c9a32ae79ba78c649e1bc4ec19cda447a2525fb364085ce67b91792ec74fe48478f13173aba
</div>
    </div>
</div></div></div></div>

      </section>

      <section id="status-list-verifiable-credential"><div class="header-wrapper"><h3 id="a-2-status-list-verifiable-credential"><bdi class="secno">A.2 </bdi>Status List Verifiable Credential</h3><a class="self-link" href="#status-list-verifiable-credential" aria-label="Permalink for Appendix A.2"></a></div>
        
<div class="example" id="example-a-status-list-verifiable-credential">
        <div class="marker">
    <a class="self-link" href="#example-a-status-list-verifiable-credential">Example<bdi> 4</bdi></a><span class="example-title">: A Status List Verifiable Credential</span>
  </div> 
      <div class="vc-tabbed"><input type="radio" id="vc-tab2unsigned" name="vc-tabs2" checked=""><input type="radio" id="vc-tab2ecdsa-rdfc-2019" name="vc-tabs2"><input type="radio" id="vc-tab2eddsa-rdfc-2022" name="vc-tabs2"><input type="radio" id="vc-tab2jose" name="vc-tabs2"><input type="radio" id="vc-tab2cose" name="vc-tabs2"><ul class="vc-tabs"><li class="vc-tab"><label for="vc-tab2unsigned"><abbr title="Unsecured credential">Credential</abbr></label></li><li class="vc-tab"><label for="vc-tab2ecdsa-rdfc-2019"><abbr title="Secured with Data Integrity - ecdsa-rdfc-2019">ecdsa</abbr></label></li><li class="vc-tab"><label for="vc-tab2eddsa-rdfc-2022"><abbr title="Secured with Data Integrity - eddsa-rdfc-2022">eddsa</abbr></label></li><li class="vc-tab"><label for="vc-tab2jose"><abbr title="Secured with JOSE">jose</abbr></label></li><li class="vc-tab"><label for="vc-tab2cose"><abbr title="Secured with COSE">cose</abbr></label></li></ul><div class="vc-tab-content" style="min-height: 367px;"><pre class="nohighlight vc" data-vc-vm="https://example.edu/issuers/565049/keys/1" data-vc-tabs="ecdsa-rdfc-2019 eddsa-rdfc-2022 jose cose">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "<span class="highlight">https://example.com/credentials/status/3</span>",
  "type": ["VerifiableCredential", "<span class="highlight">BitstringStatusListCredential</span>"],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "<span class="highlight">BitstringStatusList</span>",
    "statusPurpose": "<span class="highlight">revocation</span>",
    "encodedList": "<span class="highlight">uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA</span>"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 367px;"><strong>application/vc</strong>
            <pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/status/3",
  "type": [
    "VerifiableCredential",
    "BitstringStatusListCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "BitstringStatusList",
    "statusPurpose": "revocation",
    "encodedList": "uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "created": "2025-02-23T18:04:37Z",
    "verificationMethod": "did:key:zDnaeYANR4Bey6DhjY5uF7d1k3EXaWTKqVDz7a1jhgqSGfhjc",
    "cryptosuite": "ecdsa-rdfc-2019",
    "proofPurpose": "assertionMethod",
    "proofValue": "z2TyJsaPhZeyerWDv92SHnhtEH9mFnGdToSGx5zxFPXagG9CCDnhLbnXU2ZBQdztprNxnpzspSDLsxkZG1Rmygo42"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 367px;"><strong>application/vc</strong>
            <pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/status/3",
  "type": [
    "VerifiableCredential",
    "BitstringStatusListCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "BitstringStatusList",
    "statusPurpose": "revocation",
    "encodedList": "uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "created": "2025-02-23T18:04:37Z",
    "verificationMethod": "did:key:z6Mkkicdg7gYwr1kU8M2gxC1GgLBVGvYbepeu1dMatdq5naq",
    "cryptosuite": "eddsa-rdfc-2022",
    "proofPurpose": "assertionMethod",
    "proofValue": "z2cMpbPFogHtmxwTGzjbLA43LzJWB2PNcAQ4CrnhCuCzVkbtFNjQCpyp23QDajqJtVRgJzoXcib9L6D21Jb4mTVe8"
  }
}</pre></div><div class="vc-tab-content" style="min-height: 367px;">
<div class="vc-jose-cose-jwt-tabbed">
    <div class="vc-jose-cose-jwt-tab-content">
<strong>Protected Headers</strong>
<pre>{
  "kid": "ExHkBMW9fmbkvV266mRpuP2sUY_N_EWIN1lapUzO8ro",
  "alg": "ES256"
}
</pre>
<strong>application/vc</strong>
<pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/status/3",
  "type": [
    "VerifiableCredential",
    "BitstringStatusListCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "BitstringStatusList",
    "statusPurpose": "revocation",
    "encodedList": "uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA"
  }
}
</pre>
<strong>application/vc+jwt</strong>
<div class="jose-text">
<div class="jwt-compact">
<span class="jwt-header">eyJraWQiOiJFeEhrQk1XOWZtYmt2VjI2Nm1ScHVQMnNVWV9OX0VXSU4xbGFwVXpPOHJvIiwiYWxnIjoiRVMyNTYifQ</span>
.<span class="jwt-payload">eyJAY29udGV4dCI6WyJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvdjIiLCJodHRwczovL3d3dy53My5vcmcvbnMvY3JlZGVudGlhbHMvZXhhbXBsZXMvdjIiXSwiaWQiOiJodHRwczovL2V4YW1wbGUuY29tL2NyZWRlbnRpYWxzL3N0YXR1cy8zIiwidHlwZSI6WyJWZXJpZmlhYmxlQ3JlZGVudGlhbCIsIkJpdHN0cmluZ1N0YXR1c0xpc3RDcmVkZW50aWFsIl0sImlzc3VlciI6ImRpZDpleGFtcGxlOjEyMzQ1IiwidmFsaWRGcm9tIjoiMjAyMS0wNC0wNVQxNDoyNzo0MFoiLCJjcmVkZW50aWFsU3ViamVjdCI6eyJpZCI6Imh0dHBzOi8vZXhhbXBsZS5jb20vc3RhdHVzLzMjbGlzdCIsInR5cGUiOiJCaXRzdHJpbmdTdGF0dXNMaXN0Iiwic3RhdHVzUHVycG9zZSI6InJldm9jYXRpb24iLCJlbmNvZGVkTGlzdCI6InVINHNJQUFBQUFBQUFBLTNCTVFFQUFBRENvUFZQYlF3Zm9BQUFBQUFBQUFBQUFBQUFBQUFBQUlDM0FZYlNWS3NBUUFBQSJ9fQ</span>
.<span class="jwt-signature">p7RGv0eeS3S6zxg6qZHzFcyGbaF4FIE9ltZLvuW8MRzvHJ3P7zlGhysi9_mUgFtwX5xs0V5oDVj1TAcmtOC2Ow</span>
</div>
</div>
    </div>
</div></div><div class="vc-tab-content" style="min-height: 367px;">
<div class="vc-jose-cose-cose-tabbed">
    <div class="vc-jose-cose-cose-tab-content">
<strong>application/vc</strong>
<pre>{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/status/3",
  "type": [
    "VerifiableCredential",
    "BitstringStatusListCredential"
  ],
  "issuer": "did:example:12345",
  "validFrom": "2021-04-05T14:27:40Z",
  "credentialSubject": {
    "id": "https://example.com/status/3#list",
    "type": "BitstringStatusList",
    "statusPurpose": "revocation",
    "encodedList": "uH4sIAAAAAAAAA-3BMQEAAADCoPVPbQwfoAAAAAAAAAAAAAAAAAAAAIC3AYbSVKsAQAAA"
  }
}
</pre>
<strong>application/vc+cose</strong>
<div class="cose-text">
d28444a1013822a05901e47b2240636f6e74657874223a5b2268747470733a2f2f7777772e77332e6f72672f6e732f63726564656e7469616c732f7632222c2268747470733a2f2f7777772e77332e6f72672f6e732f63726564656e7469616c732f6578616d706c65732f7632225d2c226964223a2268747470733a2f2f6578616d706c652e636f6d2f63726564656e7469616c732f7374617475732f33222c2274797065223a5b2256657269666961626c6543726564656e7469616c222c22426974737472696e675374617475734c69737443726564656e7469616c225d2c22697373756572223a226469643a6578616d706c653a3132333435222c2276616c696446726f6d223a22323032312d30342d30355431343a32373a34305a222c2263726564656e7469616c5375626a656374223a7b226964223a2268747470733a2f2f6578616d706c652e636f6d2f7374617475732f33236c697374222c2274797065223a22426974737472696e675374617475734c697374222c22737461747573507572706f7365223a227265766f636174696f6e222c22656e636f6465644c697374223a2275483473494141414141414141412d33424d514541414144436f505650625177666f414141414141414141414141414141414141414149433341596253564b734151414141227d7d5840c6147d995f24bfd6333ae710771ee614964f2bbf29569cb477f7badf70c5f2e3105a2c4f5a1c30f122d41c7b06e0db72dbd817c848f2727865369da1b755ec87
</div>
    </div>
</div></div></div></div>
      </section>

      <section id="multiple-status-lists-in-one-verifiable-credential"><div class="header-wrapper"><h3 id="a-3-multiple-status-lists-in-one-verifiable-credential"><bdi class="secno">A.3 </bdi>Multiple Status Lists in One Verifiable Credential</h3><a class="self-link" href="#multiple-status-lists-in-one-verifiable-credential" aria-label="Permalink for Appendix A.3"></a></div>
        

        <p>
This specification enables an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-issuers">issuer</a> to associate multiple status lists
with a single <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-verifiable-credential">verifiable credential</a>.
        </p>

        <div class="example" id="example-associating-multiple-status-lists-with-a-single-verifiable-credential">
        <div class="marker">
    <a class="self-link" href="#example-associating-multiple-status-lists-with-a-single-verifiable-credential">Example<bdi> 5</bdi></a><span class="example-title">: Associating multiple status lists with a single Verifiable Credential</span>
  </div> <pre class="nohighlight" data-vc-vm="https://example.edu/issuers/565049/keys/1" data-vc-tabs="ecdsa-rdfc-2019 eddsa-rdfc-2022 jose cose">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": ["VerifiableCredential"],
  "issuer": "did:example:12345",
  "issuanceDate": "2021-04-05T14:27:42Z",
  <span class="comment">// note the use of an array to represent the set of
  // status entries</span>
  "credentialStatus": <span class="highlight">[{
    "id": "https://example.com/credentials/status/3#94567",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "https://example.com/credentials/status/3"
  }, {
    "id": "https://example.com/credentials/status/4#12345",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "suspension",
    "statusListIndex": "12345",
    "statusListCredential": "https://example.com/credentials/status/4"
  }]</span>,
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  }
}</pre>
      </div>
      </section>

      <section id="multiple-status-entries-in-a-single-list"><div class="header-wrapper"><h3 id="a-4-multiple-status-entries-in-a-single-list"><bdi class="secno">A.4 </bdi>Multiple Status Entries in a Single List</h3><a class="self-link" href="#multiple-status-entries-in-a-single-list" aria-label="Permalink for Appendix A.4"></a></div>
        

        <p>
It is possible for a single status list to contain multiple types of status
purposes. Doing so can make the retrieval of a list slightly more efficient
than fetching multiple status lists.
        </p>

        <div class="example" id="example-associating-multiple-status-entries-in-a-single-status-list">
        <div class="marker">
    <a class="self-link" href="#example-associating-multiple-status-entries-in-a-single-status-list">Example<bdi> 6</bdi></a><span class="example-title">: Associating multiple status entries in a single status list</span>
  </div> <pre class="nohighlight" data-vc-vm="https://example.edu/issuers/565049/keys/1" data-vc-tabs="ecdsa-rdfc-2019 eddsa-rdfc-2022 jose cose">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "https://example.com/credentials/23894672394",
  "type": ["VerifiableCredential"],
  "issuer": "did:example:12345",
  "issuanceDate": "2021-04-05T14:27:42Z",
  <span class="comment">// note the use of a single list to store multiple
  // status entries</span>
  "credentialStatus": [{
    "id": "<span class="highlight">https://example.com/credentials/status/5#94567</span>",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "revocation",
    "statusListIndex": "94567",
    "statusListCredential": "<span class="highlight">https://example.com/credentials/status/5</span>"
  }, {
    "id": "<span class="highlight">https://example.com/credentials/status/5#12345</span>",
    "type": "BitstringStatusListEntry",
    "statusPurpose": "suspension",
    "statusListIndex": "12345",
    "statusListCredential": "<span class="highlight">https://example.com/credentials/status/5</span>"
  }],
  "credentialSubject": {
    "id": "did:example:6789",
    "type": "Person"
  }
}</pre>
      </div>
    </section>
  </section>

  <section id="revision-history"><div class="header-wrapper"><h2 id="b-revision-history"><bdi class="secno">B. </bdi>Revision History</h2><a class="self-link" href="#revision-history" aria-label="Permalink for Section B."></a></div>
    

    <p>
This section contains the substantive changes that have been made to this
specification over time.
    </p>

    <p>
Changes since the
<a href="https://www.w3.org/TR/2024/CR-vc-bitstring-status-list-20240521/">
v1.0 First Candidate Recommendation</a>:
    </p>
    <ul>
      <li>
Many editorial updates to clarify grammar, flow, and understanding of the
specification contents.
      </li>
      <li>
Provided final guidance on using decoy values and validity periods for status
lists.
      </li>
      <li>
Add a context and vocabulary section.
      </li>
      <li>
Clarify that the <code>ttl</code> property doesn't override validity
      </li>
      <li>
Add a <code>refresh</code> status purpose.
      </li>
      <li>
Remove integer error codes from problem details
      </li>
    </ul>
  </section>

  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="c-references"><bdi class="secno">C. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix C."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="c-1-normative-references"><bdi class="secno">C.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix C.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-infra">[infra]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-rdf-concepts">[RDF-CONCEPTS]</dt><dd>
      <a href="https://www.w3.org/TR/rdf-concepts/"><cite>Resource Description Framework (RDF): Concepts and Abstract Syntax</cite></a>. Graham Klyne; Jeremy Carroll.  W3C. 10 February 2004. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf-concepts/">https://www.w3.org/TR/rdf-concepts/</a>
    </dd><dt id="bib-rfc1952">[RFC1952]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc1952"><cite>GZIP file format specification version 4.3</cite></a>. P. Deutsch.  IETF. May 1996. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc1952">https://www.rfc-editor.org/rfc/rfc1952</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc4648">[RFC4648]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. S. Josefsson.  IETF. October 2006. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc9457">[RFC9457]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9457"><cite>Problem Details for HTTP APIs</cite></a>. M. Nottingham; E. Wilde; S. Dalal.  IETF. July 2023. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9457">https://www.rfc-editor.org/rfc/rfc9457</a>
    </dd><dt id="bib-rfc9458">[RFC9458]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc9458"><cite>Oblivious HTTP</cite></a>. M. Thomson; C. A. Wood.  IETF. January 2024. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc9458">https://www.rfc-editor.org/rfc/rfc9458</a>
    </dd><dt id="bib-vc-data-integrity">[VC-DATA-INTEGRITY]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-integrity/"><cite>Verifiable Credential Data Integrity 1.0</cite></a>. Manu Sporny; Ted Thibodeau Jr; Ivan Herman; Dave Longley; Greg Bernstein.  W3C. 23 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-data-integrity/">https://www.w3.org/TR/vc-data-integrity/</a>
    </dd><dt id="bib-vc-data-model-2.0">[VC-DATA-MODEL-2.0]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Manu Sporny; Ted Thibodeau Jr; Ivan Herman; Gabe Cohen; Michael Jones.  W3C. 23 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="c-2-informative-references"><bdi class="secno">C.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix C.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-allosaur">[ALLOSAUR]</dt><dd>
      <a href="https://eprint.iacr.org/2022/1362.pdf"><cite>ALLOSAUR: Accumulator with Low-Latency Oblivious Sublinear Anonymous credential Updates with Revocations</cite></a>.  Cryptology ePrint Archive. January 5th, 2024. URL: <a href="https://eprint.iacr.org/2022/1362.pdf">https://eprint.iacr.org/2022/1362.pdf</a>
    </dd><dt id="bib-cid">[CID]</dt><dd>
      <a href="https://www.w3.org/TR/cid-1.0/"><cite>Controlled Identifiers v1.0</cite></a>. Manu Sporny; Michael Jones.  W3C. 18 February 2025. CRD. URL: <a href="https://www.w3.org/TR/cid-1.0/">https://www.w3.org/TR/cid-1.0/</a>
    </dd><dt id="bib-html-rdfa">[HTML-RDFA]</dt><dd>
      <a href="https://www.w3.org/TR/html-rdfa/"><cite>HTML+RDFa 1.1 - Second Edition</cite></a>. Manu Sporny.  W3C. 17 March 2015. W3C Recommendation. URL: <a href="https://www.w3.org/TR/html-rdfa/">https://www.w3.org/TR/html-rdfa/</a>
    </dd><dt id="bib-json-ld11">[JSON-LD11]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11/"><cite>JSON-LD 1.1</cite></a>. Gregg Kellogg; Pierre-Antoine Champin; Dave Longley.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11/">https://www.w3.org/TR/json-ld11/</a>
    </dd><dt id="bib-rfc2560">[RFC2560]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2560"><cite>X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</cite></a>. M. Myers; R. Ankney; A. Malpani; S. Galperin; C. Adams.  IETF. June 1999. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc2560">https://www.rfc-editor.org/rfc/rfc2560</a>
    </dd><dt id="bib-rfc5280">[RFC5280]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc5280"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. D. Cooper; S. Santesson; S. Farrell; S. Boeyen; R. Housley; W. Polk.  IETF. May 2008. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>
    </dd><dt id="bib-rfc7231">[RFC7231]</dt><dd>
      <a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. R. Fielding, Ed.; J. Reschke, Ed. IETF. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
    </dd><dt id="bib-rfc8932">[RFC8932]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8932"><cite>Recommendations for DNS Privacy Service Operators</cite></a>. S. Dickinson; B. Overeinder; R. van Rijswijk-Deij; A. Mankin.  IETF. October 2020. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8932">https://www.rfc-editor.org/rfc/rfc8932</a>
    </dd><dt id="bib-turtle">[TURTLE]</dt><dd>
      <a href="https://www.w3.org/TR/turtle/"><cite>RDF 1.1 Turtle</cite></a>. Eric Prud'hommeaux; Gavin Carothers.  W3C. 25 February 2014. W3C Recommendation. URL: <a href="https://www.w3.org/TR/turtle/">https://www.w3.org/TR/turtle/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-document" aria-label="Links in this document to definition: conforming document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-document" aria-label="Permalink for definition: conforming document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-document-1" title="§ 1.3 Conformance">§ 1.3 Conformance</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-processor" aria-label="Links in this document to definition: conforming processor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-processor" aria-label="Permalink for definition: conforming processor. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>